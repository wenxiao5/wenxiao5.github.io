\documentclass[11pt]{elegantbook}
\usepackage{graphicx}
%\usepackage{float}
\definecolor{structurecolor}{RGB}{40,58,129}
\linespread{1.6}
\setlength{\footskip}{20pt}
\setlength{\parindent}{0pt}
\newcommand{\argmax}{\operatornamewithlimits{argmax}}
\newcommand{\argmin}{\operatornamewithlimits{argmin}}
\elegantnewtheorem{proof}{Proof}{}{Proof}
\elegantnewtheorem{claim}{Claim}{prostyle}{Claim}
\DeclareMathOperator{\col}{col}
\title{Choice Modeling}
\author{Wenxiao Yang}
\institute{Haas School of Business, University of California Berkeley}
\date{2024}
\setcounter{tocdepth}{2}
\extrainfo{All models are wrong, but some are useful.}

\cover{cover.png}

% modify the color in the middle of titlepage
\definecolor{customcolor}{RGB}{32,178,170}
\colorlet{coverlinecolor}{customcolor}
\usepackage{cprotect}

\addbibresource[location=local]{reference.bib} % bib

\begin{document}
\maketitle

\frontmatter
\tableofcontents

\mainmatter






\chapter{Random Utility Models}
\section{Random Utility Models}
Let $j=1,...,J_i$ index the ``inside goods'' available to consumer $i$ while $j=0$ denotes the outside good. A consumer's choice set is characterized by $J_i$ and a set $\chi_i$, which may include
\begin{enumerate}[$\circ$]
    \item observed characteristics of consumer $i$,
    \item observed characteristics of goods (including prices),
    \item observed characteristics of the local market,
    \item and characteristics of the market or goods that are unobserved to the researcher.
\end{enumerate}
Each consumer $i$ has a (conditional indirect) utility $u_{ij}$ for good $j$. Consumer knows her utilities for all goods and chooses the good with the highest utility.

In this model, the heterogeneity of consumer preferences is modeled by random utilities:
\begin{definition}[Random Utility Model]
    Given the choice set $(J_i, \chi_i)$, each consumer's utility vector $(u_{ij})_{j=0,1,...,J_i}$ is an independent draw from a joint distribution $F_u(\cdot\mid J_i, \chi_i)$.
\end{definition}
Since only the ordinal ranking of goods matters for a consumer's behavior, we can normalize the location and scale of each consumer's utility vector without loss of generality. We assume that ``ties'' ($u_{ij}=u_{ik}$ for some $j\neq k$) occur with probability zero in the distribution $F_u(\cdot\mid J_i, \chi_i)$. Then, we can represent consumer $i$'s choice with the vector $(q_{i1},...,q_{iJ_i})$, where
\begin{equation}
    \begin{aligned}
        q_{ij}=\mathbf{1}\{u_{ij}\geq u_{ik},\forall k\}
    \end{aligned}
    \nonumber
\end{equation}
The consumer-specific choice probabilities are then given by
\begin{equation}
    \begin{aligned}
        s_{ij}:=\mathbb{E}[q_{ij}\mid J_i,\chi_i]=\int_{\mathcal{A}_{ij}}d F_u\left(u_{i0},...,u_{iJ_i}\mid J_i, \chi_i\right)
    \end{aligned}
    \nonumber
\end{equation}
where $\mathcal{A}_{ij}=\{(u_{i0},...,u_{iJ_i})\in\mathbb{R}^{J_i+1}\mid u_{ij}\geq u_{ik},\forall k\}$.


\section{The Canonical Model}
\begin{definition}[Canonical Model]
    Discrete choice demand models are frequently formulated using a parametric random utility specification such as
    \begin{equation}
        \begin{aligned}
            u_{ijt}=x_{jt}\beta_{it}-\alpha_{it}p_{jt}+\xi_{jt}+\epsilon_{ijt}
        \end{aligned}
        \nonumber
    \end{equation}
    for $j>0$, with $u_{i0t}=\epsilon_{i0t}$.
\end{definition}

The notion of a “market” $t$ allows a precise characterization of the endogeneity problems inherent to demand estimation (In practice, markets are typically defined by natural combinations of time and geography). Let $\mathcal{J}_t$ denote the set of products (inside goods) available to consumers in market $t$, and let $J_t=|\mathcal{J}_t|$.

Let $x_t=(x_{1t},...,x_{J_t,t}), p_t=(p_{1t},...,p_{J_t,t}), \xi_t=(\xi_{1t},..., \xi_{J_t,t})$, and $\chi_t=(x_t,p_t,\xi_t)$.

\begin{enumerate}
    \item $p_{jt}$ represents the price of good $j$ in market $t$, while $x_{jt}\in \mathbb{R}^K$ represents other observable characteristics of good $j$ in the market.
    \item $\xi_{jt}$ is \textit{ a demand shock}, an unobserved factor associated with good $j$ and market $t$.
    \subitem $\circ$ ($\xi_{jt}$ can represent any combination of latent taste variation and latent product characteristics common to consumers in market $t$. For example, a high value of $\xi_{jt}$ may simply indicate that consumers in market $t$ have a high mean taste for good $j$.)
    \subitem $\circ$ ($\xi_{jt}$ is correlated with $p_{jt}$ and $x_{jt}$ by the endogeneity of prices and additional characteristics.)
    \item $\epsilon_{ijt}$ is the \textit{error term}. It is most often specified as an i.i.d. draw from a standard type-1 extreme value distribution, yielding a \textit{mixed multinomial logit model}.
    \subitem $\circ$ Choice probabilities in the population reflect a mixture of the choice probabilities conditional on each possible combination of ($\alpha_{it},\beta_{it}$). In this case, the choice probabilities in the population (i.e., the market shares) are given by
    \begin{equation}
        \begin{aligned}
            s_{jt}=\int \frac{e^{x_{jt}\beta_{it}-\alpha_{it}p_{jt}+\xi_{jt}}}{\sum_{k=0}^{J_t}e^{x_{kt}\beta_{it}-\alpha_{it}p_{kt}+\xi_{kt}}}d F(\alpha_{it},\beta_{it};t)
        \end{aligned}
        \nonumber
    \end{equation}
    where the latent taste parameters $\alpha_{it}$ and $\beta_{it}$ are often referred to as ``random coefficients,'' and $F(\cdot;t)$ denotes their joint distribution in market $t$.
    \subitem $\circ$ Alternatively, a normal distribution will yield a mixed multinomial probit.
    \item The joint distribution $F(\cdot;t)$ is commonly specified as follows.
    \begin{enumerate}
        \item Each component $k$ of the random coefficient vector $\beta_{it}$ typically specified takes the form
        \begin{equation}
            \begin{aligned}
                \beta_{it}^{(k)}=\beta_{0}^{(k)}+\beta_{v}^{(k)}v_{it}^{(k)}+\sum_{l=1}^L\beta_{d}^{(l,k)}d_{ilt}
            \end{aligned}
            \nonumber
        \end{equation}
        Remind that the $\beta_{it}^{(k)}$ contributes as $x_{jt}^{(k)}\beta_{it}^{(k)}$.
        \begin{enumerate}
            \item The $\beta_{0}^{(k)}$ is a parameter shifting all consumers' tastes for additional characteristics $x_{jt}^{(k)}$
        \end{enumerate}
        \item 
    \end{enumerate}
\end{enumerate}
















\end{document}