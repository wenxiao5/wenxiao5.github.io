\documentclass[11pt]{elegantbook}
\definecolor{structurecolor}{RGB}{40,58,129}
\linespread{1.6}
\setlength{\footskip}{20pt}
\setlength{\parindent}{0pt}
\newcommand{\argmax}{\operatornamewithlimits{argmax}}
\newcommand{\argmin}{\operatornamewithlimits{argmin}}
\elegantnewtheorem{proof}{Proof}{}{Proof}
\elegantnewtheorem{claim}{Claim}{prostyle}{Claim}
\DeclareMathOperator{\col}{col}
\title{\textbf{ECON 201B}}
\author{Wenxiao Yang}
\institute{Haas School of Business, University of California Berkeley}
\date{2024}
\setcounter{tocdepth}{2}
\cover{cover.png}
\extrainfo{Seeking what is true is not seeking what is desirable.}

% modify the color in the middle of titlepage
\definecolor{customcolor}{RGB}{9,119,119}
\colorlet{coverlinecolor}{customcolor}
\usepackage{cprotect}

\addbibresource[location=local]{reference.bib} % bib

\begin{document}

\maketitle
\frontmatter
\tableofcontents
\mainmatter


\chapter{Game Theory}
Based on
\begin{enumerate}[$\circ$]
    \item "Kreps, D. M., \& Sobel, J. (1994). Signalling. \textit{Handbook of game theory with economic applications}, 2, 849-867."
    \item Mas-Colell, Whinston, and Green, Microeconomic Theory, Oxford University Press (1995).
    \item UIUC ECON 530 21Fall, Nolan H. Miller
    \item UC Berkeley ECON 201A 23Fall, 201B 24Spring
    \item UC Berkeley MATH 272 23Fall, Alexander Teytelboym
    \item  Jehle, G., Reny, P.: Advanced Microeconomic Theory. Pearson, 3rd ed. (2011). Ch. 6.
\end{enumerate}


\section{Basic Game Theory}
\subsection{Action and Domination Theorem}
Let $A$ be the finite set of possible actions and $\Omega$ be the finite set of possible states. A function can map the action and state to a value, $u(a,\omega)$. It can be represented by $\vec{u}(a)=\{u(a,\omega)\}_{\omega\in\Omega}$. It is common in game theory to assume the utility function is given or known.

A \textbf{mixed action} is a probability distribution over $A$, $\sigma\in\Delta(A)$.

A \textbf{belief} of the agent is a probability distribution over $\Omega$, $\mu\in\Delta(\Omega)$.

\begin{definition}[Optimal and Justifiable Mixed Action]
    \normalfont
    A mixed action $\sigma\in\Delta(A)$ is \textbf{optimal} given $\mu\in\Delta(\Omega)$ if $$\mathbb{E}_\mu u(\sigma,\tilde{\omega})\geq \mathbb{E}_\mu u(\sigma',\tilde{\omega}),\ \forall \sigma'\in \Delta(A)$$
    A mixed action $\sigma\in\Delta(A)$ is \textbf{justifiable} if it is optimal for some belief $\mu\in\Delta(\Omega)$.
\end{definition}

\begin{definition}[Dominant and Dominated Action]
    \normalfont
    A mixed action $\sigma\in\Delta(A)$ is \textbf{dominant} if $$u(\sigma,\omega)>u(\sigma',\omega),\ \forall \omega\in \Omega, \sigma'\in \Delta(A),\sigma\neq\sigma'$$
    A mixed action $\sigma\in\Delta(A)$ is \textbf{dominated} if $$u(\sigma,\omega)<u(\sigma',\omega),\ \forall \omega\in \Omega, \text{ and for some } \sigma'\in \Delta(A)$$
    In this case we say $\sigma'$ dominates $\sigma$.
\end{definition}

\begin{theorem}[Domination Theorem: Justifiable $=$ Not Dominated]
    A mixed action is justifiable \underline{if and only if} it is not dominated.
\end{theorem}
\begin{proof}
    $\Rightarrow$ is easily proved by the definition. We focus on proving $\Leftarrow$:
    
    Let $\mathcal{U}=\{\vec{u}(\sigma):\sigma\in\Delta(A)\}$ and $\sigma^*$ be an undominated mixed action. Then, we have $\mathcal{U}\cap(\{\vec{u}(\sigma^*)\}+\mathbb{R}_{++}^\Omega)=\emptyset$. Because $\mathcal{U}$ and $\{\vec{u}(\sigma^*)\}+\mathbb{R}_{++}^\Omega$ are disjoint, convex, and nonempty, we can use the Separating Hyperplane Theorem \ref{SHT}: $\exists p\in \mathbb{R}^\Omega,p\neq 0$ such that $p\cdot a\leq p\cdot b, \forall a\in\mathcal{U}, b\in (\{\vec{u}(\sigma^*)\}+\mathbb{R}_{++}^\Omega)$.

    \begin{claim}
        $p\cdot \vec{u}(\sigma)\leq p\cdot \vec{u}(\sigma^*), \forall \sigma\in\Delta(A)$.
    \end{claim}
    \begin{proof}
        For any positive number $m$, $\vec{u}(\sigma^*)+(\frac{1}{m},....,\frac{1}{m})\in \{\vec{u}(\sigma')\}+\mathbb{R}_{++}^\Omega$. So, for any $\sigma\in\Delta(A)$, $p\cdot \vec{u}(\sigma)\leq p\cdot\left(\vec{u}(\sigma^*)+(\frac{1}{m},....,\frac{1}{m})\right)$. By taking limit, $p\cdot \vec{u}(\sigma^*)=\lim_{m \rightarrow \infty}p\cdot\left(\vec{u}(\sigma^*)+(\frac{1}{m},....,\frac{1}{m})\right)\geq p\cdot \vec{u}(\sigma)$.
    \end{proof}
    \begin{claim}
        $p>0$.
    \end{claim}
    \begin{proof}
        Prove by the contradiction. Suppose $p_\omega<0$ for some $\omega\in\Omega$. Let $z=(\epsilon,...,\epsilon)+M\mathbb{1}_\omega, M>0,\epsilon>0$. So, $\vec{u}(\sigma^*)+z\in (\{\vec{u}(\sigma^*)\}+\mathbb{R}_{++}^\Omega)$. We have $p\cdot\vec{u}(\sigma^*)\leq p\cdot (\vec{u}(\sigma^*)+z)$ by the result of SHT. There is a contradiction since $p_\omega<0$. So, we have $p\geq 0$. Because $p\neq 0$, $p>0$ is proved.
    \end{proof}
    Finally, we normalize $p$ to $\mu=\frac{1}{\sum_{\omega}p_\omega}p$. Then, $\sigma^*$ is optimal for the belief $\mu$, which means $\sigma^*$ is justifiable.
\end{proof}










\subsection{Extensive Game}
\begin{definition}[History]
    \normalfont
    The sequences of actions are called \textbf{histories}. $h'=(\underbrace{a_1,...,a_n}_{h: \text{prefix of }h'},a_{n+1},...)\in H$. We call $h'$ is the \textbf{continuation} of $h$. $h$ is a \textbf{terminal} of $H$ if there is no continuation of $h$ in $H$. ($\emptyset\in H$.)
\end{definition}

\begin{definition}[Extensive form Perfect Information Game]
    \normalfont
    Am extensive form game with prefect information is defined as $G=\{N,A,H,Z,P,O,o,\succ_{n\in N}\}$, where $N$ is the set of players, $A$ is the set of actions, $H$ is the set of all histories, $Z$ is the set of all histories that are terminals, $P:H/Z \rightarrow N$ is a mapping from a non-terminal histories to a player (who moves after a non-terminal history), $O$ is the set of outcomes, and $o$ is a function from $Z$ to $O$.\\
    A PIG is \underline{finite horizon} if there is a bound on the length of its histories.
\end{definition}


We denote $A(h)$ as the actions available to player $P(h)$ after a history $h$.

Let $H_i=\{h\in H/Z:i=P(h)\}$ be the set of histories that player $i$ moves after.

\begin{definition}[Strategy]
    \normalfont
    A \textbf{strategy} is defined as a function $s_i:H_i \rightarrow A$ for which $s_i(h)\in A(h),\forall h\in H_i$. Let $S_i$ be the set of all strategies available to the player $i$. A \textbf{strategy profile} is a collection of strategy $s=(s_i)_{i\in N}$.
\end{definition}



\begin{definition}[Subgame]
\normalfont
    A \textbf{subgame} of a PIG $G=\{N,A,H,Z,P,O,o,\succ_{n\in N}\}$ is a game (a PIG) that starts after a given finite history $h\in H$. Formally, the subgame $G(h)$ associated with $h=(h_1,...,h_n)\in H$ is $G(h)=\{N,A,H_h,Z,P_h,O,o_h,\succ_{n\in N}\}$, where
    \begin{equation}
        \begin{aligned}
            H_h=\{(a_1,a_2,...):(h_1,...,h_n,a_1,a_2,...)\in H\}\\
            o_h(h')=o(hh'), P_h(h')=P(hh')
        \end{aligned}
        \nonumber
    \end{equation}
    A strategy $s$ of $G$ defines a strategy $s_h$ of $G(h)$ by $s_h(h')=s(hh')$.
\end{definition}

\begin{definition}[Subgame Perfect Equilibrium (SPNE)]
    \normalfont
    A \textbf{subgame perfect equilibrium (SPNE)} of $G$ is a strategy profile $s^*$ such that for every subgame $G(h)$ it holds that $h^{\prime} \mapsto s_i^*\left(h h^{\prime}\right)$ is an optimal strategy in $G(h)$, given beliefs that the rest of the players behave according to $s_{-i}^*$ (or its restriction to $G(h)$).
\end{definition}

\begin{definition}[Profitable Deviation]
    \normalfont
    Let $s$ be a strategy profile. We say that $s_i^{\prime}$ is a \textbf{profitable deviation} from $s$ for player $i$ at history $h$ if $s_i^{\prime}$ is a strategy for $G$ such that
    $$
    o_h\left(s_i^{\prime}, s_{-i}\right) \succ_i o_h(s)
    $$
\end{definition}
Note that a strategy profile has no profitable deviations iff it's a SPNE.

\begin{theorem}[The one-deviation principle]
    Let $G=\left(N, A, H, O, o, P,\left\{\preceq_i\right\}_{i \in N}\right)$ be a finite horizon, extensive form game with perfect information. Let $s$ be a strategy profile that is \underline{not} a subgame perfect equilibrium. There exists some history $h$ and a profitable deviation $\bar{s}_i$ for player $i=P(h)$ in $G(h)$ such that $\bar{s}_i(k)=s_i(k)$ for all $k \neq h$.
\end{theorem}
\begin{enumerate}[$\circ$]
    \item Let $G=\left(N, A, H, O, o, P,\left\{\preceq_i\right\}_{i \in N}\right)$ be a PIG.
    \item $A(\emptyset)$ is the set of allowed initial actions for player $i=P(\emptyset)$. For each $b \in A(\emptyset)$, let $s^{G(b)}$ be some strategy profile for the subgame $G(b)$.
    \item Given some $a \in A(\emptyset)$, we denote by $s^a$ the strategy profile for $G$ in which player $i=P(\emptyset)$ chooses the initial action $a$, and for each action $b \in A(\emptyset)$ the subgame $G(b)$ is played according to $s^{G(b)}$.
    \item So $s_i^a(\emptyset)=a$ and for every player $j, b \in A(\emptyset)$ and $b h \in H \backslash Z$, $s_j^a(b h)=s_j^{G(b)}(h)$.
\end{enumerate}
\begin{lemma}[Backward Induction]
    Let $G=\left(N, A, H, Z, O, o, P,\left\{\preceq_i\right\}_{i \in N}\right)$ be a finite PIG. Assume that for each $b \in A(\emptyset)$ the subgame $G(b)$ has a subgame perfect equilibrium $s^{G(b)}$. Let $i=P(\emptyset)$ and let $a$ be the $\succ_i$-maximizer over $A(\emptyset)$ of $o_a\left(s^{G(a)}\right)$. Then $s^a$ is a subgame perfect equilibrium of $G$.
\end{lemma}


\subsection{Strategic Form Game}
\begin{definition}[Normal Form Game]
    \normalfont
    A game in \textbf{normal form} is denoted by $$G =\left(\underbrace{N}_{\textnormal{players}},\underbrace{\{S_i\}_{i\in N}}_{\textnormal{Strategy Set}},\underbrace{\{u_i(\cdot)\}_{i\in N}}_{\textnormal{VNM utility}}\right)$$

    $u_i:\prod_{i\in I}S_i \rightarrow \mathbb{R}$ is the utility function that maps all players' strategies to a player's utilities.

    A \underline{finite} game is a normal-form game in which the set of players $N$ is a finite set, and the set of strategy profiles $S$ is finite.
\end{definition}

\begin{definition}[Mixed/Pure Strategy]
\normalfont
A mixed strategy  for player $i$ is a probability distribution $\sigma_i\in\Delta(S_i)$.\\
Elements of $S_i$ are called pure strategies.
\end{definition}

\begin{definition}[Dominant/Dominated Strategy]
    \normalfont
    A strategy $\sigma_i\in \Delta(S_i)$ is a \textbf{dominant strategy} for $i$ in $G$, if we have $u_i(\sigma_i,\sigma_{-i})> u_i(\sigma'_i,\sigma_{-i}), \forall \sigma'_i\neq \sigma_i, \sigma_{-i}\in\times_{j\neq i}\Delta(S_j)$.\\
    A strategy $\sigma_i\in \Delta(S_i)$ is a \textbf{dominated strategy} for $i$ in $G$, if $\exists \sigma'_i\neq \sigma_i$, $u_i(\sigma_i,\sigma_{-i})<u_i(\sigma'_i,\sigma_{-i}), \forall \sigma_{-i}\in\times_{j\neq i}\Delta(S_j)$.\\
    A strategy $\sigma_i\in \Delta(S_i)$ is a \textbf{weakly dominated strategy} for $i$ in $G$, if $\exists \sigma'_i\neq \sigma_i$, $u_i(\sigma_i,\sigma_{-i})\leq u_i(\sigma'_i,\sigma_{-i}), \forall \sigma_{-i}\in\times_{j\neq i}\Delta(S_j)$ and there is a $\sigma_{-i}\in\times_{j\neq i}\Delta(S_j)$, $u_i(\sigma_i,\sigma_{-i})< u_i(\sigma'_i,\sigma_{-i})$
\end{definition}

\begin{lemma}
    1. A dominant strategy is always pure.\\
    2. A strategy $\sigma'_i$ dominates $\sigma_i$ iff $u_i(\sigma'_i,s_{-i})> u_i(\sigma_i,s_{-i})$, for all pure strategy profiles $s_{-i}\in S_{-i}$.
\end{lemma}


\begin{definition}[Belief, Best Response]
    \normalfont
    A \textbf{belief} for player $i$ is a probability distribution $\mu\in\Delta(S_{-i})$.\\
    A strategy $\sigma_i \in \Delta(S_i)$ is the \textbf{best response} to beliefs $\mu$ if it solves the problem of $\max_{\sigma_i\in\Delta(S_i)}u_i(\sigma_i,s_{-i})$.\\
    Denote the set of all best responses to $\mu$ by $\beta_i(\mu)$.
\end{definition}
\begin{lemma}[Mixed Strategy is BR iff its Pure Strategies are Indifferent]
    A mixed strategy $\sigma_i$ is in $\beta_i(\mu)$ iff every pure strategy in the support of $\sigma_i$ is in $\beta_i(\mu)$. In particular, every strategy in the support of $\sigma_i$ yields the same payoff to $i$.
\end{lemma}

\begin{theorem}[Domination Theorem rephrased]
    In a finite game, a strategy is dominated iff there is no belief to which it is a best response.
\end{theorem}


\begin{definition}[Algorithm: Iterated Elimination of Dominated Strategies (IEDS)]
    \normalfont
    Let $\left(N,\left(S_i\right),\left(u_i\right)\right)$ be a finite game; $N=[n]$.
    \begin{enumerate}[$\bullet$]
        \item We define (inductively) $n$ sequences of sets of mixed strategies.
        \item Let $D_i^0=\Delta\left(S_i\right)$.
        \item Given $D_1^{k-1}, \ldots, D_n^{k-1}$, let
        $$
        D_i^k=\left\{\sigma_i: \nexists \bar{\sigma}_i: u_i\left(\sigma_i, \sigma_{-i}\right)<u_i\left(\bar{\sigma}_i, \sigma_{-i}\right) \forall \sigma_{-i} \in \times_{j \neq i} D_j^{k-1}\right\} .
        $$
        \item Note that $\left\{D_i^k\right\}$ is a decreasing sequence of sets.
        \item Let $D_i = \cap_{k=0}^\infty D_i^k$.
        \item The set $D = \times_{i=1}^n D_i$ be the set of strategies that survive the iterated elimination of dominated strategies.
    \end{enumerate}
    A game is called \textbf{dominance-solvable} if $D$ is a singleton.
\end{definition}


\begin{definition}[Rationalizable Strategies]
\normalfont
    \begin{enumerate}[$\bullet$]
        \item $R_i^0=\Delta\left(S_i\right)$.
        \item Given $R_1^{k-1}, \ldots, R_n^{k-1}$, Let
        $$
        \begin{aligned}
        & Z_i^k=\left\{s_i \in S_i: \sigma_i\left(s_i\right)>0 \text { for some } \sigma_i \in R_i^{k-1}\right\} \\
        & R_i^k=\left\{\sigma_i \in \Delta\left(S_i\right): \exists \mu \in \Delta\left(\times_{j \neq i} Z_j^k\right) \text { s.t. } \sigma_i \in \beta_i(\mu)\right\}
        \end{aligned}
        $$
    \end{enumerate}
    Note: $\left\{R_i^k\right\}_{k=0}^{\infty}$ is a decreasing sequence of sets.\\
    Let $R_i=\cap_{k=0}^{\infty} R_i^k$.\\
    The \textbf{rationalizable strategies} are the elements of $R=\times_{i=1}^n R_i$.
\end{definition}

\begin{lemma}
    In a finite game, $R$ is always non-empty and contains a pure strategy profile.
\end{lemma}

\begin{proposition}
    $\sigma_i \in \Delta(S_i)$ is \textbf{rationalizable} iff there are sets $Z_1,..., Z_n, Z_j \subseteq S_j$ such that
    \begin{enumerate}
        \item $\sigma_i \in \beta_i(\mu_i)$ for some $\mu_i \in \Delta(\times_{h\neq i}Z_h)$.
        \item for every $s_j \in Z_j$ there is $\mu_j \in \Delta(\times_{h\neq j}Z_h)$ such that $s_j\in \beta_j(\mu_j)$.
    \end{enumerate}
\end{proposition}

\begin{corollary}[Rationalizable = IEDS]
    Rationalizable strategies are exactly the strategies survive the iterated elimination of dominated strategies, $$R=D$$
\end{corollary}
















\subsection{Nash Equilibrium and Existence}
\begin{definition}[Nash Equilibrium]
    \normalfont
    A strategy profile $\Sigma=(\sigma_1,...,\sigma_I)$ is a \textbf{Nash} equilibrium of the game $G$ if for every $i\in I$, we have: $u_i(\sigma^*_i,\sigma^*_{-i})\geq u_i(\sigma'_i,\sigma^*_{-i}), \forall \sigma'_i\in \Delta(S_i)$ (no profitable deviation). In other words,
    \begin{enumerate}
        \item $\sigma_i$ is the \underline{best response} to beliefs $\mu_i\in \Delta (S_{-i})$
        \item $\mu_i=\sigma_{-i}$ (correct beliefs).
    \end{enumerate}
\end{definition}
\begin{enumerate}
    \item In rationalizable strategies, beliefs can be incorrect.
    \item In a Nash equilibrium, beliefs are correct. Any strategy in a Nash equilibrium is rationalizable.
\end{enumerate}

\begin{definition}[Best Response Correspondence]
    \normalfont
    In a Nash equilibrium the player $i$'s best response correspondence $\beta_i:\Delta(S_{-i})\rightarrow 2^{\Delta(S_i)}$ is defined as $\beta_i(\sigma_{-i})=\arg\max_{\sigma_i\in\Delta(S_i)}u_i(\sigma_i,\sigma_{-i})$. Let $\beta(\sigma)=\times_{i\in I}\beta_i(\sigma_{-i})$. Then $\sigma$ is a Nash equilibrium iff $\beta(\sigma)=\sigma$. $\beta$ is called the \textbf{best response correspondence} of the game.
\end{definition}

\begin{theorem}[Existence of Nash Equilibrium]
    A Nash equilibrium exists in a finite game $\Gamma$, if for all $i\in I$,
    \begin{enumerate}[(i).]
        \item $S_i$ is non-empty, convex, compact, subset of $\mathbb{R}^m$ (i.e., for some finite dimensions of real numbers).
        \item $u_i(s_i,...,s_I)$ is continuous in $(s_i,...,s_I)$ and quasi-concave in any $s_i$.
    \end{enumerate}
\end{theorem}
\begin{proof}
    We prove a lemma for the best response correspondence $\beta_i(s_{-i})=\argmax_{s_i\in S_i}u(s_i,s_{-i})$ firstly.
    \begin{lemma}
        Suppose $\{S_i\}_{i\in I}$ are non-empty. Suppose that $S_i$ is compact and convex and $u_i$ is continuous in $(s_i,...,s_I)$ and quasi-concave in any $s_i$, then best response correspondence $\beta_i(s_{-i})$ is non-empty, convex-valued and uhc.
    \end{lemma}
    \begin{proof}
        This lemma is proved by Berge's Maximum Theorem (Theroem \ref{thm:Berge's Maximum Theorem}).
    \end{proof}
    Consider the best response correspondence of the game $\beta$ with $\beta(s_i,...,s_I)=\{\beta_1(s_{-1}),...,\beta_I(s_{-I})\}$.

    As we proved $\beta$ is non-empty, convex-valued and uhc from $S$ to $S$ where $S$ is non-empty, compact, and convex. By the Kakutani's Fixed Point Theorem (Theorem \ref{thm:Kakutani's Fixed Point Theorem}), we have $\beta$ has a fixed point $s\in S$, which should be the Nash equilibrium.
\end{proof}

\subsection{Bayesian Game}
\begin{definition}[Bayesian Game]
    \normalfont
    A \textbf{Bayesian game} is defined by $$\Gamma=(I, \Omega, \{A_i\}_{i\in I}, \{u_i(\cdot)\}_{i\in I},\{\Theta_i\}_{i\in I}, \{F_i\}_{i\in I})$$
    where $\Omega$ is the state space, $u_i:A\times \Omega$ is $i$'s payoff function, and $F_i\in\Delta\left(\Omega\times\Theta_i\right)$ is the (prior) distribution of the player $i$'s type.
\end{definition}

\begin{definition}[Normal-form Bayesian game]
    \normalfont
    Assume a finite game. The \textbf{normal-form game} can be represented by $$\left(I,(S_i,U_i)_{i\in I}\right)$$ defined by letting $S_i$ be the set of strategies based on types $s_i:\Theta_i \rightarrow A_i$ and
    \begin{equation}
        \begin{aligned}
            U_i(s)=\sum_{\omega\in\Omega}\sum_{(\theta_i)_{i\in I}\in \Theta}p(\omega,\theta_1,...,\theta_I)u_i(s_1(\theta_1),..., s_I(\theta_I),\omega)
        \end{aligned}
        \nonumber
    \end{equation}
    for all $s\in S$.

    A \textbf{Bayesian Nash equilibrium} (BNE) of a Bayesian game is a strategy profile $(s_1,...,s_n)$ that is a Nash equilibrium of the derived normal-form game.
\end{definition}

\begin{definition}[Best Response, Interim Payoff]
    \normalfont
    $s_i$ is a BR to $s_{-i}$ iff for all $\theta_i$, $s_i(\theta_i)$ maximizes the \textbf{interim payoff} of player $i$. The interim payoff is defined by the expected payoff given the type $\theta_i$ of player $i$ by playing action $a_i$.
    \begin{equation}
        \begin{aligned}
            \mathbb{E}_{\omega\in\Omega,\tilde{\theta}_{-i}\in\Theta_{-i}}[u_i(a_i,s_{-i}(\tilde{\theta}_{-i}),\omega)|\theta_i]
        \end{aligned}
        \nonumber
    \end{equation}
\end{definition}


\section{Adverse Selection}
Consider a labor market that has many identical firms. In competitive equilibrium, firms' profits are $0$. Firms are price (wage) takers, risk-neutral, and CRS. There are continuum of workers with productivity levels $\theta\in\left[\underline{\theta},\overline{\theta}\right]$ (Assume workers work if it is indifferent for them between employment and non-employment).
\begin{enumerate}
    \item $\theta\sim F$, $F(\cdot)$ is a c.d.f. over $\left[\underline{\theta},\overline{\theta}\right]$.
    \item $N$ is the total mass of workers.
    \item Type $\theta$ worker has a reservation utility $r(\theta)$.
\end{enumerate}

\begin{enumerate}[$\circ$]
    \item Suppose the competitive equilibrium wages are $\theta=w^*(\theta)$.
    \item An allocation is denoted by $I:\left[\underline{\theta},\overline{\theta}\right] \rightarrow \{0,1\}$, where $I(\theta)=0$ denotes $\theta$ is unemployed and $I(\theta)=1$ denotes $\theta$ is employed.
    \item Aggregate welfare = sum of utilities of all participants
    \begin{equation}
        \begin{aligned}
            =N\int_{\underline{\theta}}^{\overline{\theta}} \left[I(\theta)\times\theta+[1-I(\theta)]r(\theta)\right]dF(\theta)
        \end{aligned}
        \nonumber
    \end{equation}
    Then we have the optimal allocation satisfies
    \begin{equation}
        \begin{aligned}
            I^*(\theta)=\left\{\begin{matrix}
                1,&\theta>r(\theta)\\
                0,1&\theta=r(\theta)\\
                0,&\theta<r(\theta)
            \end{matrix}\right.
        \end{aligned}
        \nonumber
    \end{equation}
\end{enumerate}
In the asymmetric information case,
\begin{definition}
\normalfont
$w$ is CE wage if $w=\mathbb{E}[\theta|r(\theta)\leq w]$.
\end{definition}

\subsection{Adverse Selection}
\begin{assumption}
    \begin{enumerate}[({A}1).]
        \item $r$ is strictly increasing in $\theta$.
        \item $F(\cdot)$ has a strictly positive density, $F(\theta)>0, \forall \theta\in \left[\underline{\theta},\overline{\theta}\right]$.
        \item $r(\theta)\leq\theta$ (outside option is worse than productivity, i.e., full employment is optimal).
    \end{enumerate}
\end{assumption}

\begin{lemma}
    Under A1-A3, $\Phi(w):=\mathbb{E}[\theta|r(\theta)\leq w]$ is well-defined, continuous, and non-decreasing.
\end{lemma}

Hence, there exists underemployment, which makes $1^{st}$ welfare theorem fails. There may exist multiple CEs, where the one with the highest wage Pareto dominates others.

\begin{example}
    Suppose $\theta\in[0,2]$, $F(\theta)=\frac{\theta}{2}$, $f(\theta)=\frac{1}{2}$, $r(\theta)=\alpha\theta,\alpha\in(0,1)$.
    \begin{equation}
        \begin{aligned}
            \mathbb{E}[\theta|r(\theta)\leq w]=\mathbb{E}\left[\theta|\theta \leq \frac{w}{\alpha}\right]=\left\{\begin{matrix}
                1,&w\geq 2\alpha\\
                \frac{1}{F\left(\frac{w}{\alpha}\right)}\int_0^{\frac{w}{\alpha}}\theta f(\theta)d\theta=\frac{w}{2\alpha},&w\leq 2\alpha
            \end{matrix}\right.
        \end{aligned}
        \nonumber
    \end{equation}
    CEs are given by $\mathbb{E}[\theta|r(\theta)\leq w]=w$. $w^*=0$ is always CE and $w^*=1$ is CE if $\alpha\leq\frac{1}{2}$.
\end{example}

\subsection{Game Theoretical Approach}
\begin{enumerate}
    \item Suppose there are two firms setting wages simultaneously.
    \item Workers observe the wages in stage 1 and make an employment decision.
\end{enumerate}
Let $W^*$ be the set of CE wages and $w^*:=\max W^*$.
\begin{lemma}\label{lemma:ad_l2}
    $\forall w'\in\left(w^*,\overline{\theta}\right]$: $\mathbb{E}[\theta|r(\theta)\leq w']<w'$.
\end{lemma}
\begin{proof}
    Suppose by the contradiction that $\exists w'\in \left(w^*,\overline{\theta}\right]$ s.t. $\mathbb{E}[\theta|r(\theta)\leq w']\geq w'$. Since $\mathbb{E}[\theta|r(\theta)\leq \overline{\theta}]<\overline{\theta}$, there must exist a $w''\in [w',\overline{\theta})$ s.t. $\mathbb{E}[\theta|r(\theta)\leq w'']=w''$ by intermediate value theorem, which contradicts to the definition of $w^*$.
\end{proof}

\begin{proposition}
    \begin{enumerate}[(i).]
        \item If $w^*>r(\underline{\theta})$ and $\exists \epsilon>0$ s.t. $\mathbb{E}[\theta|r(\theta)\leq w']>w',\forall w'\in \left(w^*-\epsilon,w^*\right)$. Then, there is a unique SPE where both firms set wage $=w^*$.
        \item If $w^*=r(\underline{\theta})$ (complete market shutdown at $w^*$), there are multiple SPE that all give the same outcome as complete market shutdown where both firms set wage $=w^*$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{lemma}\label{lemma:p1}
        In all SPE, firms make zero profits.
    \end{lemma}
    \begin{proof}
        Suppose not, i.e., at least one firm makes strictly positive profits. Then, the total profits of firms $1\&2$, $$\Pi=M(\bar{w})\left[\mathbb{E}[\theta|r(\theta)\leq\bar{w}]-\bar{w}\right]>0$$
        where $\bar{w}$ is the max wage set by the two firms and $M(\bar{w})$ is the mass of workers willing to work at $\bar{w}$. At least one firm, $i$, makes profit $\leq\frac{\Pi}{2}$. Then, $i$'s profits from setting $\bar{w}+\delta$, with $\delta \rightarrow 0^+$, is higher:
        \begin{equation}
            \begin{aligned}
                &M(\bar{w}+\delta)\left[\mathbb{E}[\theta|r(\theta)\leq\bar{w}+\delta]-\bar{w}-+\delta\right]\\
                \geq &M(\bar{w})\left[\mathbb{E}[\theta|r(\theta)\leq\bar{w}+\delta]-\bar{w}-+\delta\right] \rightarrow \Pi \textnormal{ as }\delta \rightarrow 0
            \end{aligned}
            \nonumber
        \end{equation}
        Hence, the $i$ has incentive to deviate.
    \end{proof}
    \begin{lemma}\label{lemma:p2}
        In all SPE, firm $i$ sets $w_i\leq w^*, i\in\{1,2\}$.
    \end{lemma}
    \begin{proof}
        Directly given by Lemma \ref{lemma:ad_l2} and Lemma \ref{lemma:p1}.
    \end{proof}
    \begin{enumerate}[(i):]
        \item In SPE, no firm $i$ sets $w_i<w^*$: suppose $w_i<w^*$ and let $j\neq i$, take any $w'_j$ s.t. $w'_j\in\left(w_i,w^*\right)$ and $w'_j>w^*-\epsilon$. Then, $j$ gets profit: $M(w'_j)\left[\mathbb{E}[\theta|r(\theta)\leq w'_j]-w'_j\right]>0$ (by Case (i)'s conditions).
        \item By Lemma \ref{lemma:p2}, both firms set $w_i\leq w^*=r(\underline{\theta})$. Check that $\{(w_1,w_2):w_1,w_2\leq w^*\}$ is SPE wage profiles.
    \end{enumerate}
\end{proof}

\subsection{Planner Intervention}
Planner can't observe the true type $\theta$.

The planner's tools:
\begin{enumerate}
    \item Take over the firms.
    \item $w_e$, employment wage.
    \item $w_u$, unemployment wage.
\end{enumerate}
s.t. budget balanced.

\begin{definition}[Constrained Efficient]
    \normalfont
    A CE $w$ is \textbf{constrained efficient} if it cannot be Pareto improved upon by an intervention by the planner.
\end{definition}

\begin{proposition}[$w^*:=\max W^*$ is constrained efficient]
    Let $W^*$ be the set of CE wages. $w^*:=\max W^*$ is constrained efficient.
\end{proposition}
\begin{proof}
    Note that both firms are making zero profits by the Lemma \ref{lemma:p1}. Any CE wage $w\neq w^*$ can be Pareto improved by $\{w_e=w^*,w_u=0\}$. Then, we prove $w^*$ can't be Pareto improved.
    \begin{enumerate}
        \item Case 1: if $w^*$ gives full-employment in CE, then $w^*$ is Pareto efficient.
        \item Case 1: suppose $w^*$ doesn't give full-employment in CE.
        
        Consider taking an intervention $w_e\&w_u$. Then, $\{\theta:r(\theta)+w_u\leq w_e\}=[\underline{\theta},\hat{\theta}]$ for some $\hat{\theta}\in[\underline{\theta},\overline{\theta}]$ such that
        \begin{equation}
            \begin{aligned}
                r(\hat{\theta})+w_u=w_e
            \end{aligned}
            \label{con:1}
        \end{equation}
        The budget balanced gives
        \begin{equation}
            \begin{aligned}
                w_e F(\hat{\theta})+w_u (1-F(\hat{\theta}))=\int_{\underline{\theta}}^{\hat{\theta}}\theta d F(\theta)
            \end{aligned}
            \label{con:2}
        \end{equation}
        Plug \eqref{con:1} into \eqref{con:2}:
        \begin{equation}
            \begin{aligned}
                \left\{\begin{matrix}
                    &w_u(\hat{\theta})=\int_{\underline{\theta}}^{\hat{\theta}}\theta d F(\theta)-r(\hat{\theta})F(\hat{\theta})=F(\hat{\theta})\left(\mathbb{E}[\theta|\theta\leq\hat{\theta}]-r(\hat{\theta})\right)\\
                    &w_e(\hat{\theta})=\int_{\underline{\theta}}^{\hat{\theta}}\theta d F(\theta)+r(\hat{\theta})(1-F(\hat{\theta}))
                \end{matrix}\right.
            \end{aligned}
            \nonumber
        \end{equation}
        Let $\theta^*$ be s.t. $r(\theta^*)=w^*$. Because $w^*$ is a CE price, $\mathbb{E}[\theta|\theta\leq\theta^*]=r(\theta^*)=w^*$. So, CE with $w^*$ can be implemented by $w_u(\theta^*)=0$ and $w_e(\theta^*)=w^*$.
        \begin{enumerate}
            \item If $\hat{\theta}<\theta^*$. $\underline{\theta}$ is worse off under the intervention since $w_e(\hat{\theta})<w^*$.
            \item If $\hat{\theta}>\theta^*$. $\overline{\theta}$ is worse off under the intervention since $w_u(\hat{\theta})=F(\hat{\theta})\left(\mathbb{E}[\theta|\theta\leq\hat{\theta}]-r(\hat{\theta})\right)<0$ by the Lemma \ref{lemma:ad_l2}
        \end{enumerate}
    \end{enumerate}
\end{proof}


\subsection{Signaling}\label{sec:signaling}
Suppose the worker $\theta\in[\underline{\theta},\overline{\theta}]$ can properly and costlessly reveal his type to the firms. Then,
\begin{lemma}
    All workers revel their types.
\end{lemma}
\paragraph*{Spence's Job Market Signaling Model} One worker has productivity $\theta\in\{\theta_L,\theta_H\}$ with $P(\theta_H)=\lambda$. The worker signal through his education with cost $e>0$. The education doesn't change his productivity. The payoff of the worker is the wage minus the cost:
\begin{equation}
    \begin{aligned}
        u(w,e|\theta)=w-c(e,\theta)
    \end{aligned}
    \nonumber
\end{equation}
where $c(0,\theta)=0,c_e(e,\theta):=\frac{\partial c(e,\theta)}{\partial e}>0, c_\theta(e,\theta):=\frac{\partial c(e,\theta)}{\partial \theta}<0$, and $c_{e\theta}(e,\theta):=\frac{\partial^2 c(e,\theta)}{\partial e\partial \theta}<0$ (Single-Crossing Property, the difference $c(e,\theta_L)-c(e,\theta_H)$ is increasing in $e$ (i.e., $c_e(e,\theta_L)-c_e(e,\theta_H)>0$), which means if $c(e,\theta_L)$ and $c(e,\theta_H)$ intersect as functions of $e$, they only intersect at one time.)
\begin{enumerate}[]
    \item \underline{Stage 0}: Nature chooses the $\theta\in\{\theta_L,\theta_H\}$ with $P(\theta_H)=\lambda$.
    \item \underline{Stage 1}: The worker learns $\theta$ and chooses $e(\theta)\geq 0$.
    \item \underline{Stage 2}: Firms observe $e(\theta)$. Then, they simultaneously make wage offers $w_1$ and $w_2$.
    \item \underline{Stage 3}: The worker observes $w_1,w_2$ and makes employment decision.
\end{enumerate}
Let $r(\theta_L)$ and $r(\theta_H)=0$. Let $\mu(e)\in[0,1]$ be the probability that in the beginning of stage 2, firms think that the worker is $\theta_H$ type with probability $\mu(e)$ when observing $e$. The corresponding expected productivity (the highest wage) that the firm can pay is
\begin{equation}
    \begin{aligned}
        w(e)=\mu(e)\theta_H+(1-\mu(e))\theta_L
    \end{aligned}
    \nonumber
\end{equation}
In stage 2, both firm will set $w(e)$ (complete competition).

\begin{definition}[Perfect Bayesian Equilibrium]
    \normalfont
    A PBE is a strategy profile ($e^*(\theta_L)$, $e^*(\theta_H)$, $w^*_1: \mathbb{R}_+ \rightarrow \mathbb{R}$, $w^*_2: \mathbb{R}_+ \rightarrow \mathbb{R}$), and a belief $\mu^*: \mathbb{R} \rightarrow [0,1]$ such that
    \begin{enumerate}
        \item $\forall \theta\in\{\theta_L,\theta_H\}$, the worker strategy optimal given firm strategies.
        \item The belief $\mu^*(e)$ is derived from $\lambda, e^*(\theta_L), e^*(\theta_H)$ via Bayes' rule whenever possibly (on the equilibrium path). Outside the equilibrium path the belief $\mu^*(e)$ is arbitrarily.
        \item Firms offer wages that form a NE of the stage 2 game, where their belief $\mu^*(e)$ about their workers' type. (sequential rationality).
    \end{enumerate}
\end{definition}
We simplify the game by backward induction:
\begin{enumerate}
    \item \underline{Stage 3}: The worker chooses the highest wage off if it is $\geq 0$.
    \item \underline{Stage 2}: After observing $e(\theta)$, firms chooses the wage as the expected productivity in NE,
    \begin{equation}
        \begin{aligned}
            w^*(e)=\mu^*(e)\theta_H+(1-\mu^*(e))\theta_L
        \end{aligned}
        \nonumber
    \end{equation}
    because it is a Bertrend competition.
\end{enumerate}
\paragraph*{Separating Equilibrium}
In separating equilibrium, $e^*(\theta_L)\neq e^*(\theta_H)$.
\begin{lemma}
    In any separating PBE, $w^*(e^*(\theta))=\theta, \forall \theta\in\{\theta_L,\theta_H\}$.
\end{lemma}
\begin{proof}
    By Bayes' rule, after firm observe $e^*(\theta_L)$, $\mu^*(e^*(\theta_L))=0$. Then, $w^*(e^*(\theta_L))=\theta_L$. ($e^*(\theta_H)$ is similar.)
\end{proof}

\begin{lemma}
    In separating PBE, low type always chooses zero education, $\theta^*(\theta_L)=0$.
\end{lemma}
\begin{proof}
    If not, the low type worker always has profitable deviation, $\theta^*(\theta_L)=0$.
\end{proof}

\begin{lemma}
    Define $\underline{e}$ and $\overline{e}$ such that
    \begin{enumerate}
        \item $\theta_L=\theta_H-c(\underline{e},\theta_L)$ (the lowest effort can prevent the low type from mimicking high type) and
        \item $\theta_L=\theta_H-c(\overline{e},\theta_H)$ (the highest effort can prevent the high type from pooling with low type).
    \end{enumerate}
    Then, in all separating PBEs, $e\in \left[\underline{e},\overline{e}\right]$.\\
    Conversely, $\forall \hat{e}\in \left[\underline{e},\overline{e}\right]$, there is a separating PBE where $e^*(\theta_H)=\hat{e}$.
\end{lemma}
These different PBEs are Pareto ranked. High type prefers the PBE with a lower $e$ (the best is the one with $e^*(\theta_H)=\underline{e}$.)

\paragraph*{Pooling PBE}
$e^*(\theta)=e^*,\theta\in\{\theta_L,\theta_H\}$, $\mu^*(e^*)=\lambda$, and $w^*(e^*)=\mathbb{E}[\theta]$.

\begin{lemma}
    Define $e'$ by $\theta_L=\mathbb{E}[\theta]-c(e',\theta_L)$ (the highest effort can prevent the low type from choosing $e=0$ and get $w=\theta_L$.)\\
    Then, for all pooling PBE, $e^*(\theta_L)=e^*(\theta_H)=e^*\in[0,e']$. Conversely, for all $\hat{e}\in [0,e']$, there is a pooling PBE with $e^*=\hat{e}$.
\end{lemma}


\subsection{Cho-Kreps Intuitive Criterion}
\begin{definition}[Equilibrium Dominated Message]
    \normalfont
    A message is \textbf{equilibrium dominated} for a type if the type must do strictly worse by sending the message than it does in equilibrium (i.e., payoff in eq. is strictly better than maximum payoff from deviating).
\end{definition}

\begin{definition}[Cho-Kreps Intuitive Criterion]
    \normalfont
    If an information set is off the eq. path and a message is eq. dominated for a type, then beliefs should assign zero probability to the message coming from that type (if possible).
\end{definition}

Fix a PBE $e^*(\theta), \theta\in\{\theta_L,\theta_H\}, \mu^*(\cdot)$ (We know $w_1^*(e)=w_2^*(e)=\mu(e)\theta_H+(1-\mu(e))\theta_L$). Let $u^*(\theta),\theta\in\{\theta_L,\theta_H\}$ be the PBE utility of the type $\theta$ worker.

The criterion requires the (off-path) belief $\mu^*(e):=P(\tilde{\theta}=\theta_H|e)=1-P(\tilde{\theta}=\theta_L|e)$ satisfies $$P(\tilde{\theta}=\theta|e)=0,\forall e,\theta$$ such that
\begin{enumerate}
    \item $u^*(\theta)>\max_{w\in[\underline{\theta},\overline{\theta}]}[w-c(e,\theta)]$
    \item $\exists \theta'$ s.t. $u^*(\theta')\leq \max_{w\in[\underline{\theta},\overline{\theta}]}[w-c(e,\theta')]$ (make sure the sum of beliefs given $e$ is nonzero.)
\end{enumerate}
In this application, the only PBE that survives Intuitive Criterion is the best separating PBE, $e^*(\theta_H)=\underline{e}$ (the lowest effort).


\subsection{Screening Model}
Workers can undertake a contractible/observable task level $t\geq 0$. The utility of a worker is defined by $u(w,t,\theta):=w-c(t,\theta)$, where $c(\cdot,\cdot)$ satisfies the same assumption as in signaling model \ref{sec:signaling}.

The Game follows
\begin{enumerate}[]
    \item \underline{Stage 1}: Two firms simultaneously determine sets of contracts, $(w,t)$.
    \item \underline{Stage 2}: The worker observes all offer contracts and makes employment decision.
    (If indifference, choose lower task contract, favor employment over unemployment. If contracts of firms are indifferent, choose each with probability 1/2.)
\end{enumerate}

The null contract is $(w,t)=(0,0)$. Assume WLOG at stage 1, each firm appears a non-empty set of contracts.

\subsubsection*{Perfect Information}
\begin{proposition}[Perfect Information]
    If firms can observe the worker types, then in SPE firms make zero profit and type $\theta_i$ worker signs $(w^*_i,t^*_i)=(\theta_i,0)$.
\end{proposition}
\begin{proof}
    \begin{claim}
        Firms make zero profits from this contract.
    \end{claim}
    \begin{proof}
        Suppose not,
    \begin{enumerate}[$\circ$]
        \item $w^*_i>\theta_i$ $\Rightarrow$ negative profits, firms benefit from offering null contract.
        \item $w^*_i<\theta_i$ $\Rightarrow$ Let $\Pi$ be the total profits of the firms. Then one of the firms makes profit $\leq \frac{\Pi}{2}$. Then, this firm can benefit from offering $(w^*_i+\Delta,t^*_i)$, where $\Delta \rightarrow 0^+$.
    \end{enumerate}
    \end{proof}
    Then, we prove the firms must choose $(w^*_i,t^*_i)=(\theta_i,0)$. Suppose by the way of contradiction that $t_i^*>0$. Then, one firm can profitably deviate by offering $(w^*_i,0)$.
\end{proof}

\subsubsection*{Asymmetric Information}
\begin{lemma}\label{lemma:zero_profit}
    In any SPE, firms obtain zero profits,
\end{lemma}
\begin{proof}
    Firms must make profits $\geq 0$. Suppose by the way of contradiction that the total profit $\Pi>0$. Let $(w_L,t_L)$ be the contract signed by $\theta_L$ and $(w_H,t_H)$ be the contract signed by $\theta_H$. One firm can profitably deviate by offering $(w_L+\Delta,t_L)$ and $(w_H+\Delta,t_H)$, where $\Delta \in (0,\Pi)$.
\end{proof}

\begin{lemma}
    There is \textbf{no} pooling SPE.
\end{lemma}
\begin{proof}
    Suppose for a contradiction, $\exists$ an SPE where both worker types sign $(w_p=\mathbb{E}[\theta],t_p)$. Suppose one firm offers $(w_p,t_p)$, then another firm can only employ high type workers by offering $(\tilde{w},\tilde{t})$, where $\tilde{w}-c(\tilde{t},\theta_H)>\mathbb{E}[\theta]-c(t_p,\theta_H)$, $\tilde{w}-c(\tilde{t},\theta_L)<\mathbb{E}[\theta]-c(t_p,\theta_L)$, and $\tilde{w}<\theta_H$. (The existence is given by $\frac{\partial^2 c(t,\theta)}{\partial t\partial \theta}<0$.)
\end{proof}

\begin{lemma}
    Let $(w_L,t_L)$ be the contract signed by $\theta_L$ and $(w_H,t_H)$ be the contract signed by $\theta_H$ in separating SPE. Then, $w_L=\theta_L$ and $w_H=\theta_H$.
\end{lemma}
\begin{proof}
    Suppose $w_i>\theta_i,i\in\{L,H\}$, firms benefit from not offering this contract. So, $w_L\leq \theta_L$ and $w_H\leq \theta_H$.
    \begin{enumerate}
        \item \underline{$w_L=\theta_L$:} Suppose $w_L<\theta_L$. Either firm can profitably deviate by setting $(w'_L,t_L)$ such that $w_L<w'_L<\theta_L$. This offer can win all low-type workers and get a positive profit from hiring them. If $w'_L-c(t_L,\theta_H)\geq w_H-c(t_H,\theta_H)$, the offer can also hire high-type workers, which also give positive profit for the firm. Hence, there is a contradiction.
        \item \underline{$w_H=\theta_H$:} Suppose $w_H<\theta_H$, firms get positive profits, which contradicts to the Lemma \ref{lemma:zero_profit}.
    \end{enumerate}
\end{proof}

\begin{lemma}
    $\theta_L$ signs the contract $(\theta_L,0)$ in SPE.
\end{lemma}
\begin{proof}
    Suppose $t_L>0$. One firm can profitably deviate by offering $(\theta_L-\Delta,0)$.
\end{proof}

\begin{proposition}
    In any (pure strategy) SPE, $\theta_L$ signs $(w_L,t_L)=(\theta_L,0)$ and $\theta_H$ signs $(w_H,t_H)=(\theta_H,t_H)$, where $t_H$ solves
    \begin{equation}
        \begin{aligned}
            \theta_H-c(t_H,\theta_L)=\theta_L
        \end{aligned}
        \nonumber
    \end{equation}
\end{proposition}

If $\lambda:=P(\theta_H)$ is high, the pure SPE may not exist (exist $(\tilde{w},\tilde{t})$ can attract both types and make positive profit).

Cross subsidizing deviation by a firm (prices one product above its market value to fund another product), $(\tilde{w},\tilde{t})$ (signed by low type) and $(\tilde{\tilde{w}},\tilde{\tilde{t}})$ (signed by high type), is a profitable deviation if $\lambda$ is large enough.


\chapter{Mechanism Design}

\section{Mechanism Design}
Design incentives for agents to reveal their types or achieve particular society outcomes.

Given a ``direct'' mechanism,
\begin{enumerate}
    \item the set of agents $I$ with utility function $u_i(x;\theta_i),i\in I$,
    \item alternatives (outcomes for the society) $X$,
    \item  types (of agents) $\Theta=(\Theta_1,...,\Theta_I)$ with prior probability $\phi$ over $\Theta$,
    \item and a \textbf{social choice function} (SCF) $f:\Theta\rightarrow X$.
\end{enumerate}

\begin{definition}[Mechanism $\Gamma=(S,g)$]
    \normalfont
    A \textbf{mechanism} is represented as $$\Gamma=\left(S, g\right)$$
    where $S\triangleq(S_1,...,S_I)(S_1,...,S_I)$ represents the set of strategies, $S_i$ represents the strategy set of agent $i$, and $g:S\triangleq(S_1,...,S_I) \rightarrow X$ is the outcome function that determines the social outcome.
\end{definition}

A \textbf{Bayesian game induced by} $\Gamma$ is $(I,S,\Theta,\phi,\tilde{u})$, where the payoffs functions are
\begin{equation}
    \begin{aligned}
        \tilde{u}_i(s;\theta_i)=u_i(g(s);\theta_i)
    \end{aligned}
    \nonumber
\end{equation}
for all $i\in I, s\in S$, and $\theta_i\in\Theta_i$.


\subsection{Implement in Dominant Strategies}
\begin{definition}[$\Gamma$ Implements $f$]
    \normalfont
    A mechanism $\Gamma$ (indirectly) \textbf{implements} a social choice function (SCF) $f$ if there exists an ``equilibrium'' $s^*(\cdot)=\left(s_1^*(\cdot),...,s_I^*(\cdot)\right)$ of the Bayesian game induced by $\Gamma$ such that $$g(s_1^*(\theta_1),...,s_I^*(\theta_I))=f(\theta_1,...,\theta_I)$$ for all $(\theta_1,...,\theta_I)\in \Theta$. Here the ``equilibrium'' is a dominant strategy equilibrium or BNE.
\end{definition}
That is, the equilibrium in a game induced by $\Gamma$ gives the same outcome as the outcome of $f$ given by revealing agents' true types.

\begin{definition}[Direct Mechanism]
    \normalfont
    A mechanism is \textbf{direct mechanism} if agents directly report their types (types are observable). $S_i=\Theta_i$ for all $i\in I$ and $g(\theta)=f(\theta)$ for all $\theta=(\theta_1,...,\theta_I)\in\Theta$. So, a direct mechanism can be represented by $\Gamma=(\Theta,f(\cdot))$.
\end{definition}
In indirect mechanism agents don't report their types directly. Types can be observed only indirectly through signals or behavior.

A strategy is weakly dominant if for all $\theta_i\in\Theta_i$ and all $s_{-i}(\cdot)\in S_{-i}$, we have $u_i(g(s_i(\theta_i),s_{-i}),\theta_i)\geq u_i(g(s'_i,s_{-i}),\theta_i)$ for all $s'_i\neq s_i$.


\begin{definition}[Dominant Strategy Equilibrium]
    \normalfont
    Strategy profile $s^*=(s_1^*(\cdot),...,s_I^*(\cdot))$ is a \textbf{dominant strategy (D-S) equilibrium} of $\Gamma=(S,g(\cdot))$ if for all $i\in I$ and $\theta_i\in \Theta$, we have, for all $s'_i\in S_i$ and $s_{-i}\in S_{-i}$:
    \begin{equation}
        \begin{aligned}
            u_i(g(s_i^*(\theta_i),s_{-i}),\theta_i)&\geq u_i(g(s'_i,s_{-i}),\theta_i)
        \end{aligned}
        \nonumber
    \end{equation}
    equivalently, in the Bayesian game induced by $\Gamma$,
    \begin{equation}
        \begin{aligned}
            \tilde{u}_i(s_i^*(\theta_i),s_{-i},\theta_i)\geq \tilde{u}_i(s'_i,s_{-i},\theta_i)
        \end{aligned}
        \nonumber
    \end{equation}
\end{definition}

\begin{definition}[Implement in dominant strategies]
    \normalfont
    $\Gamma$ \textbf{implements} $f$ in \textbf{dominant strategies} if $\exists$ a dominant strategy (D-S) equilibrium $s^*$ of $\Gamma$ such that $g(s^*(\theta))=f(\theta)$.
\end{definition}
``$\Gamma$ implements $f$ in dominant strategies'' means that the results of the direct mechanism, $(\Theta,f(\cdot))$, are equivalent to the results of a D-S equilibrium of another (indirect) mechanism $\Gamma$. That is, $\Gamma$ can be used as $(\Theta,f(\cdot))$ ``equivalently.''
\begin{center}\begin{figure}[htbp]
    \centering
    \begin{tikzpicture}[domain=0:3.25]
        \node at (0,0) {Types: $\Theta$};
        \draw[->](1,0)--(7,0) node[right] {Alternatives: $X$};
        \draw[dashed,->](0.5,-0.5)--(3.5,-3);
        \node at (4,-3) {$s^*(\theta)$};
        \draw[dashed,->](4.5,-3)--(7.5,-0.5);
        \draw[->](0,-0.5)--(3.5,-3.5);
        \node at (4,-3.5) {$s^*=\theta$};
        \draw[->](4.6,-3.5)--(8.1,-0.5);
        \node at (0.5,-1.8) {Desirable};
        \node at (0.5,-2.2) {Situation};
        \node at (2.5,-0.9) {Indirect};
        \node at (2.5,-1.3) {Mechanism};
        \node at (2.5,-1.7) {$\Gamma$};
        \node at (6.5,-2.5) {$f(\theta)$};
        \node at (5.5,-1.5) {$g(s^*(\theta))$};
    \end{tikzpicture}
    \caption{How Mechanism Design works}
    \label{}
\end{figure}\end{center}




\subsection{Dominant-Strategy-Incentive-Compatible (DSIC)/Strategy-Proof}
\begin{definition}[Strategy-Proof, DSIC]
    \normalfont
    $f$ is \textbf{strategy-proof} (also called dominant-strategy-incentive-compatible, \textbf{DSIC}) if $$s^*_i(\theta_i)=\theta_i,\quad \forall \theta_i\in\Theta_i,i\in I$$ is a dominant strategy (D-S) equilibrium of the direct mechanism $\Gamma=(\Theta,f(\cdot))$.
\end{definition}

\begin{theorem}[Revelation Principle]
    If $\exists$ a mechanism $\Gamma=(S,g(\cdot))$ that implements $f$ in dominant strategies (i.e., $\exists$ a D-S equilibrium $s^*$ of $\Gamma$ such that $g(s^*(\theta))=f(\theta)$). Then $f$ is strategy-proof (DSIC).
\end{theorem}
\begin{proof}
    Given $\Gamma$ implements $f$ in dominant strategies, there is a  D-S equilibrium $s^*=\left(s_1^*(\cdot),...,s_I^*(\cdot)\right)$ such that $g(s^*(\theta))=f(\theta)$.\\
    By the definition of D-S equilibrium,
    \begin{equation}
        \begin{aligned}
            u_i(g(s_i^*(\theta_i),s_{-i}),\theta_i)&\geq u_i(g(s'_i,s_{-i}),\theta_i)
        \end{aligned}
        \nonumber
    \end{equation}
    By substituting $g(s^*(\theta))=f(\theta)$, we have
    \begin{equation}
        \begin{aligned}
            u_i(f(\theta_i,\theta_{-i}),\theta_i)&\geq u_i(f(\theta'_i,\theta_{-i}),\theta_i),\quad \forall \theta'_i\in\Theta_i
        \end{aligned}
        \nonumber
    \end{equation}
    which gives that $f$ is DSIC.
\end{proof}
Based on the Revelation Principle, if a ``indirect'' mechanism has a D-S equilibrium $s^*$, then the $f$ with $f(\theta)=g(s^*(\theta))$ is DSIC.



\subsection{Bayesian-Incentive-Compatible (BIC)}
\begin{definition}[BIC]
    \normalfont
    $f$ is Bayesian-incentive-compatible (B.I.C.) if $$s^*_i(\theta_i)=\theta_i,\quad \forall \theta_i\in\Theta_i,i\in I$$ is a BNE of the Bayesian game induced by the direct mechanism $\Gamma=(\Theta,f(\cdot))$.
\end{definition}
BIC is a weaker condition than DSIC, because a BNE must also be a D-S equilibrium.

\begin{theorem}[Revelation Principle (BIC)]
    If $\exists$ a mechanism $\Gamma=(S,g(\cdot))$ that implements $f$ in BNE (i.e., $\exists$ a BNE $s^*$ of $\Gamma$ such that $g(s^*(\theta))=f(\theta)$). Then $f$ is BIC.
\end{theorem}
Based on the Revelation Principle, if a ``indirect'' mechanism has a BNE $s^*$, then the $f$ with $f(\theta)=g(s^*(\theta))$ is BIC.


\subsection{Negative Results: dictatorial SCF $f$}
\begin{theorem}[Gibbard-Satterthwaite Theorem]
    Suppose that $|X|\geq 3$ and a social choice function $f$ is surjective (i.e., $\forall x\in X$ $\exists (\theta_1,...,\theta_I)\in\Theta$ s.t. $f(\theta_1,...,\theta_I)=x$). Then, $f$ is strategy-proof (DSIC) $\Leftrightarrow$ $f$ is dictatorial (\ref{SWF_properties}, i.e., $\exists i^*\in\{1,...,I\}$ such that $f(\theta)\in \argmax_{x\in X}u_{i^*}(x;\theta_{i^*})$ for all $\theta\in \Theta$).
\end{theorem}
Note: By the revelation principle, under the conditions of the Theorem, there is no mechanism that implements a non-dictatorial SCF $f$ in dominant strategies.

\begin{comment}
Some lemmas can help to prove the theorem.
\begin{lemma}
    If $f$ is strategy-proof (DSIC) and $f(\succeq)=x$ and $x\succeq_i y \Rightarrow x\succeq'_i y$ for all $i\in I$ and all $x\neq y\in X$, then $f(\succeq')=x$.
\end{lemma}

\begin{lemma}[Pareto Effeciency]
    If $f$ is strategy-proof (DSIC) and $x\succ_i y$ for all $i\in I$, then $f(\succeq')\neq y$.
\end{lemma}

\begin{example}
    Define $\succeq=\begin{pmatrix}
        x&y\\
        y&x\\
        z&z
    \end{pmatrix}$ and $\succeq'=\begin{pmatrix}
        x&y\\
        y&z\\
        z&x
    \end{pmatrix}$, each column 1/2 represents player 1/2's preferences.
\end{example}
\end{comment}


\section{Quasi-linear Model}
Consider $x=(k,\underbrace{t_1,...,t_I}_{t})\in X=K\times \mathbb{R}^I$, in our example, $K$ represents a set of choices for projects and $\mathbb{R}^I$ represents the set of transfers for all agents.

Each agent has a quasi-linear function that represents her utility:
\begin{equation}
    \begin{aligned}
        u_i(k,t,\theta_i)=v(k,\theta_i)+t_i
    \end{aligned}
    \nonumber
\end{equation}
where $v: K\times\Theta_i \rightarrow \mathbb{R}$ represents the utility without transfers.

Let $p(\cdot)=\left(k(\cdot),t(\cdot)\right)$ represents the ``project-choice rule'' $k: \Theta \rightarrow K$ and the ``transfer rule'' $t: \Theta \rightarrow \mathbb{R}^I$.
\begin{definition}[ex-post efficient]
    \normalfont
    $k(\cdot):\Theta \rightarrow K$ is \textbf{ex-post efficient} if $\nexists \left(\theta\in\Theta, k'\in K, t=(t_1,...,t_I)\in \mathbb{R}^I\right)$ such that
    \begin{enumerate}[(1).]
        \item $\sum_{i=1}^I t_i=0$
        \item $v_i(k',\theta_i)+t_i> v_i(k(\theta),\theta_i)$, $\forall i\in I$
    \end{enumerate}
    i.e., we can't get a higher total social welfare. (Because of the transfers, a higher social welfare can make everyone better off.)
\end{definition}

\begin{proposition}[ex-post efficient $\Leftrightarrow$ maximizing the sum of utilities]
    $\forall$ project-choice rule $k(\cdot)$, $k(\cdot)$ is ex-post efficient \underline{if and only if} $k(\cdot)$ maximizes the sum of utilities, i.e., $\forall \theta\in\Theta$ and $\forall k'\in K$,
    \begin{equation}
        \begin{aligned}
            \sum_{i=1}^I v_i(k(\theta),\theta_i)\geq \sum_{i=1}^I v_i(k',\theta_i)
        \end{aligned}
        \nonumber
    \end{equation}
\end{proposition}
\begin{proof}
    ``$\Leftarrow$'': Suppose by the way of contradiction that there exists $\left(\theta, k', t\right)$ such that $\sum_{i=1}^I t_i=0$ and $v_i(k',\theta_i)+t_i> v_i(k(\theta),\theta_i)$, $\forall i\in I$. Sum together, there is a contradiction.\\
    ``$\Rightarrow$'': Suppose by the way of contradiction that there exists $(\theta,k')$, $\sum_{i=1}^I v_i(k(\theta),\theta_i)<\sum_{i=1}^I v_i(k',\theta_i)$. Then, we can define a $t$ such that satisfies $\sum_{i=1}^I t_i=0$ and $v_i(k',\theta_i)+t_i> v_i(k(\theta),\theta_i)$, $\forall i\in I$. Let $\Delta=\sum_{i=1}^I v_i(k',\theta_i)-\sum_{i=1}^I v_i(k(\theta),\theta_i)$, then $t_i=v_i(k(\theta),\theta_i)-v_i(k',\theta_i)+\frac{\Delta}{I},\forall i\in I$ is the transfer-choice we want.
\end{proof}

\subsection{Vickrey-Clarke-Groves Mechanism}
\begin{proposition}[VCG Mechanism]
    Suppose $k^*(\cdot)$ is ex-post efficient project choice rule. For each $i\in \{1,...,I\}$, let $h_i:\Theta_{-i} \rightarrow \mathbb{R}$ be an arbitrary function.\\
    Define the transfer rule $t(\cdot)$ as follows
    \begin{equation}
        \begin{aligned}
            t_i(\theta_i,\theta_{-i})=\sum_{j\neq i}v_j(k^*(\theta_i,\theta_{-i}),\theta_j)+h_i(\theta_{-i})
        \end{aligned}
        \nonumber
    \end{equation}
    Then the SCF $f(\cdot)=\left(k^*(\cdot),t(\cdot)\right)$ is DSIC.
\end{proposition}
\begin{proof}
    Take any $i,\theta\in\Theta$ and let $\hat{\theta}_i\in\Theta_i$.
    Reporting truthfully gives higher profits than misreporting $\hat{\theta}_i$:
        \begin{equation}
            \begin{aligned}
                v_i(k^*(\theta_i,\theta_{-i}),\theta_i)+t_i(\theta_i,\theta_{-i})&=v_i(k^*(\theta_i,\theta_{-i}),\theta_i)+\sum_{j\neq i}v_j(k^*(\theta),\theta_j)+h_i(\theta_{-i})\\
                &=\sum_{j=1}^Iv_j(k^*(\theta),\theta_j)+h_i(\theta_{-i})\\
                &\geq \sum_{j=1}^Iv_j(k^*(\hat{\theta}_i,\theta_{-i}),\theta_j)+h_i(\theta_{-i})\\
                &=v_i(k^*(\hat{\theta}_i,\theta_{-i}),\theta_i)+t_i(\hat{\theta}_i,\theta_{-i})
            \end{aligned}
            \nonumber
        \end{equation}
    Hence, VCG mechanism with SCF $f(\cdot)=\left(k^*(\cdot),t(\cdot)\right)$ is DSIC.
\end{proof}

\begin{definition}[Pivotal VCG Mechanism (Special Case)]
    \normalfont
    Let $h_i(\theta_{-i})=\max_{k\in K}\sum_{j\neq i}v_j(k,\theta_j)$.
    \begin{equation}
        \begin{aligned}
            t_i(\theta_i,\theta_{-i})=\sum_{j\neq i}v_j(k^*(\theta_i,\theta_{-i}),\theta_j)-\max_{k\in K}\sum_{j\neq i}v_j(k,\theta_j)\leq 0
        \end{aligned}
        \nonumber
    \end{equation}
    \begin{enumerate}
        \item $i$ is \textbf{pivotal} if $k^*(\theta)$ doesn't maximize $\max_{k\in K}\sum_{j\neq i}v_j(k,\theta_j)$.
        \item $i$ is \textbf{not pivotal} if $k^*(\theta)$ maximizes $\max_{k\in K}\sum_{j\neq i}v_j(k,\theta_j)$.
    \end{enumerate}
    \begin{note}
        $i$ is \textbf{not pivotal} $\Rightarrow$ $t_i(\theta)=0$.
    \end{note}
\end{definition}

\begin{example}
    Suppose $k\in\{0,1\}, \theta\in \Theta\subset \mathbb{R}^I$, $v_i(k,\theta_i)=k\theta_i$. Since $\sum_{i=1}^Iv_i(k,\theta_i)=k\sum_{i=1}^I\theta_i$, $k^*(\cdot)$ is ex-post efficient: $k^*(\theta)=1 \Leftrightarrow \sum_{i=1}^I\theta_i\geq 0$. The pivotal VCG transfers:
    \begin{equation}
        \begin{aligned}
            t_i(\theta)=\left\{\begin{matrix}
                \sum_{j\neq i}\theta_j-0&\textnormal{ if }\sum_{j=1}^I \theta_j\geq 0>\sum_{j\neq i}\theta_j\\
                0-\sum_{j\neq i}\theta_j&\textnormal{ if }\sum_{j=1}^I \theta_j< 0\leq\sum_{j\neq i}\theta_j\\
                0&\textnormal{ otherwise}
            \end{matrix}\right.
        \end{aligned}
        \nonumber
    \end{equation}
\end{example}

\begin{example}[ (Second Price Auction)]
    One indivisible object to be allocated to one of $1,...,I$. Social decision is deciding who gets the object, $K=\{1,...,I\}$, $k=i$ means ``i receives the object''. $\Theta_i\subseteq \mathbb{R}_+$, $\theta_i\in\Theta_i$ denotes $i$'s valuation for the object $v_i(k,\theta_i)=\left\{\begin{matrix}
        \theta_i,& \textnormal{ if }k=i\\
        0,& \textnormal{ if }k\neq i
    \end{matrix}\right.$.
    Ex-post efficient $k^*(\cdot)$ allocates the object to the individual with the highest valuation. The pivotal VCG transfers:
    \begin{equation}
        \begin{aligned}
            t_i(\cdot)=\left\{\begin{matrix}
                0-\theta^{(2)}\textnormal{(the second highest)},& \textnormal{ if }k^*(\theta)=i \textnormal{ ($i$ is pivotal)}\\
                0=\theta^{(1)}-\theta^{(1)},&\textnormal{ if }k^*(\theta)\neq i
            \end{matrix}\right.
        \end{aligned}
        \nonumber
    \end{equation}
\end{example}


\begin{example}[ (Uniform-Price Auction)]
    $m$-identical indivisible objects ($m<I$). Each agent can consume $0$ or $1$ object. $K=\{M\subset \{1,...,I\}\mid |M|=m\}$, where $k=M$ is the set of agents who receive an object. $v_i(k,\theta_i)=\left\{\begin{matrix}
        \theta_i,&i\in k\\
        0,&i\notin k
    \end{matrix}\right.$. The ex-post efficient $k^*(\cdot)$ allocates the objects to top $m$-valuation agents. The pivotal VCG transfers:
    \begin{equation}
        \begin{aligned}
            t_i(\theta)=\left\{\begin{matrix}
                \left(\sum_{j=1}^m\theta_{(j)}-\theta_i\right)-\left(\sum_{j=1}^{m+1}\theta_{(j)}-\theta_i\right)=-\theta^{(m+1)}&,i\in k^*(\theta)\\
                0&,i\notin k^*(\theta)
            \end{matrix}\right.
        \end{aligned}
        \nonumber
    \end{equation}
\end{example}

\begin{example}[ (Package Auction)]
    $2$ identical indivisible objects to be allocated $I=3$ agents. Each agent can consume $0$, $1$, or $2$ units. $K=\{(1,1,0),(1,0,1),(0,1,1),(2,0,0),(0,2,0),(0,0,2)\}$. $\Theta_i=\{\theta_i=(v_1,v_2)\in \mathbb{R}^2_+\mid v_2\geq v_1\geq 0\}$. Consider an example,
    \begin{center}
        \begin{tabular}{c|c|c|c}
            \hline
                &$\theta_1$ &$\theta_2$&$\theta_3$\\
            \hline
                $v_1$&$3$ &$4$&$1$\\
            \hline
                $v_2$&$4$ &$5$&$6$\\
            \hline
        \end{tabular}
    \end{center}
    The ex-post efficient $k^*(\theta)=(1,1,0)$. Then,
    \begin{equation}
        \begin{aligned}
            t_1(\theta)=4-6=-2, t_2(\theta)=3-6=-3, t_3(\theta)=7-7=0
        \end{aligned}
        \nonumber
    \end{equation}
\end{example}


\subsection{Uniqueness of VCG Mechanism}
\begin{assumption}
    $K$ is a compact subset of a topological space which all singletons are closed (metric spaces $K\subset \mathbb{R}^n$, $K$ compact, or any finite $K$.)
\end{assumption}

Let $V_{usc}$ be the set of upper hemicontinuous functions $v: K \rightarrow \mathbb{R}$. ($v$ is upper hemicontinuous if $\forall \alpha\in \mathbb{R}: \{k\in K\mid v(k)\geq \alpha\}$ is closed.)

\textbf{Facts}: A upper hemicontinuous function attains the maximum over a compact set. Sum of upper hemicontinuous functions is upper hemicontinuous.

\begin{proposition}[Green \& Laffont 1979]\label{prop:Uniq_VCG_mechanism}
    Suppose that $\forall i: \{v_i(\cdot,\theta_i): K \rightarrow \mathbb{R}\mid \theta_i\in\Theta_i\}=V_{usc}$. Then, any ex-post efficient and DSIC direct mechanism is a VCG mechanism.
\end{proposition}
\begin{proof}
    Take any $f(\cdot)=\left(k^*(\cdot),t_i(\cdot)\right)$ such that it is ex-post efficient and DSIC. We prove it is VCG mechanism by showing there is a $h_{i}$ satisfies the definition of VCG mechanism.\\
    Define $\forall i, h_i:\Theta \rightarrow \mathbb{R}$ such that
    \begin{equation}
        \begin{aligned}
            h_i(\theta)=-\sum_{j\neq i}v_j(k^*(\theta_i,\theta_{-i}),\theta_j)+t_i(\theta_i,\theta_{-i})
        \end{aligned}
        \nonumber
    \end{equation}
    \textbf{We want to show $h_i(\theta)$ is independent of $\theta_i$ and is actually $h_i(\theta_{-i})$.}\\
    That is, $\forall \theta_i,\hat{\theta}_i,\theta_{-i}$, we want to show $h_i(\theta_i,\theta_{-i})=h_i(\hat{\theta}_i,\theta_{-i})$.
    \begin{lemma}\label{lemma:k_h}
        If $k^*(\theta_i,\theta_{-i})=k^*(\hat{\theta}_i,\theta_{-i})$, then $h_i(\theta_i,\theta_{-i})=h_i(\hat{\theta}_i,\theta_{-i})$.
    \end{lemma}
    \begin{proof}
        $k^*(\theta_i,\theta_{-i})=k^*(\hat{\theta}_i,\theta_{-i})$ requires
        \begin{equation}
            \begin{aligned}
                v_i(k^*(\theta_i,\theta_{-i}),\theta_i)+t_i(\theta_i,\theta_{-i})&\geq v_i(k^*(\hat{\theta}_i,\theta_{-i}),\theta_i)+t_i(\hat{\theta}_i,\theta_{-i})\\
                v_i(k^*(\hat{\theta}_i,\theta_{-i}),\hat{\theta}_i)+t_i(\hat{\theta}_i,\theta_{-i})&\geq v_i(k^*(\theta_i,\theta_{-i}),\hat{\theta}_i)+t_i(\theta_i,\theta_{-i})
            \end{aligned}
            \nonumber
        \end{equation}
        Since $v_i(k^*(\hat{\theta}_i,\theta_{-i}),\hat{\theta}_i)=v_i(k^*(\theta_i,\theta_{-i}),\hat{\theta}_i)$, we have $t_i(\hat{\theta}_i,\theta_{-i})=t_i(\theta_i,\theta_{-i})$. Hence, $h_i(\theta_i,\theta_{-i})=h_i(\hat{\theta}_i,\theta_{-i})$.
    \end{proof}
    \begin{enumerate}
        \item \underline{Case 1:} ``$k^*(\theta_i,\theta_{-i})=k^*(\hat{\theta}_i,\theta_{-i})$'', $h_i(\theta_i,\theta_{-i})=h_i(\hat{\theta}_i,\theta_{-i})$ is given by Lemma \ref{lemma:k_h}.
        \item \underline{Case 2:} ``$k^*(\theta_i,\theta_{-i})\neq k^*(\hat{\theta}_i,\theta_{-i})$''\\
        Suppose by the way of contradiction $h_i(\theta_i,\theta_{-i})\neq h_i(\hat{\theta}_i,\theta_{-i})$, WLOG, we consider $h_i(\theta_i,\theta_{-i})>h_i(\hat{\theta}_i,\theta_{-i})$. There is an $\epsilon>0$ s.t. $h_i(\theta_i,\theta_{-i})>h_i(\hat{\theta}_i,\theta_{-i})+\epsilon$.\\
        Define $v: K \rightarrow \mathbb{R}$ such that
        \begin{equation}
            \begin{aligned}
                v(k)=\left\{\begin{matrix}
                    -\sum_{j\neq i}v_j(k^*(\theta_i,\theta_{-i}),\theta_j),& \textnormal{ if }k=k^*(\theta_i,\theta_{-i})\\
                    -\sum_{j\neq i}v_j(k^*(\hat{\theta}_i,\theta_{-i}),\theta_j)+\epsilon,& \textnormal{ if }k=k^*(\hat{\theta}_i,\theta_{-i})\\
                    -C,&\textnormal{ otherwise}\
                \end{matrix}\right.
            \end{aligned}
            \nonumber
        \end{equation}
        where $C>\max_{k\in K}\sum_{j\neq i}v_j(k^*(k,\theta_{-i}),\theta_j)$.\\
        Hence, $v$ is upper hemicontinuous, $v\in V_{usc}$.

        By the assumption that $\forall i: \{v_i(\cdot,\theta_i): K \rightarrow \mathbb{R}\mid \theta_i\in\Theta_i\}=V_{usc}$, we know $\exists \theta^\epsilon_i\in\Theta_i$ s.t. $v_i(\cdot,\theta^\epsilon_i)=v(\cdot)$.
        \begin{enumerate}[$\circ$]
            \item Because $k^*(\cdot)$ is ex-post efficient,
            \begin{equation}
                \begin{aligned}
                    v_i(k^*(\theta^\epsilon_i,\theta_{-i}),\theta^\epsilon_i)+\sum_{j\neq i} v_j(k^*(\theta^\epsilon_i,\theta_{-i}),\theta_j)&\geq v_i(k^*(\hat{\theta}_i,\theta_{-i}),\theta^\epsilon_i)+\sum_{j\neq i} v_j(k^*(\hat{\theta}_i,\theta_{-i}),\theta_j)\\
                    &=v(k^*(\hat{\theta}_i,\theta_{-i}))+\sum_{j\neq i} v_j(k^*(\hat{\theta}_i,\theta_{-i}),\theta_j)=\epsilon
                \end{aligned}
                \nonumber
            \end{equation}
            By the definition of $v(\cdot)$, we have
            \begin{equation}
                \begin{aligned}
                    v_i(k^*(\theta^\epsilon_i,\theta_{-i}),\theta^\epsilon_i)+\sum_{j\neq i} v_j(k^*(\theta^\epsilon_i,\theta_{-i}),\theta_j)=v(k^*(\theta^\epsilon_i,\theta_{-i}))+\sum_{j\neq i} v_j(k^*(\theta^\epsilon_i,\theta_{-i}),\theta_j)\leq \epsilon
                \end{aligned}
                \nonumber
            \end{equation}
            Hence, we can conclude $k^*(\theta^\epsilon_i,\theta_{-i})=k^*(\hat{\theta}_i,\theta_{-i})$. Then, by the Lemma \ref{lemma:k_h}, $h_i(\theta^\epsilon_i,\theta_{-i})=h_i(\hat{\theta}_i,\theta_{-i})$.
            \item Because $f(\cdot)=\left(k^*(\cdot),t_i(\cdot)\right)$ is DSIC, the agent with $\theta^\epsilon_i$ gets the highest profit from truthfully reporting
            \begin{equation}
                \begin{aligned}
                    v_i(k^*(\theta^\epsilon_i,\theta_{-i}),\theta^\epsilon_i)+t_i(\theta^\epsilon_i,\theta_{-i})&\geq v_i(k^*(\theta_i,\theta_{-i}),\theta^\epsilon_i)+t_i(\theta_i,\theta_{-i})\\
                    \Leftrightarrow -\sum_{j\neq i}v_j(k^*(\theta^\epsilon_i,\theta_{-i}),\theta_j)+\epsilon+t_i(\theta^\epsilon_i,\theta_{-i})&\geq-\sum_{j\neq i}v_j(k^*(\theta_i,\theta_{-i}),\theta_j)+t_i(\theta_i,\theta_{-i})\\
                    \Leftrightarrow h_i(\theta^\epsilon_i,\theta_{-i})+\epsilon&\geq h_i(\theta_i,\theta_{-i})\\
                    \Leftrightarrow h_i(\hat{\theta}_i,\theta_{-i})+\epsilon&\geq h_i(\theta_i,\theta_{-i})
                \end{aligned}
                \nonumber
            \end{equation}
            There is a contradiction.
        \end{enumerate}
    \end{enumerate}
\end{proof}


\subsection{Budget Balancedness of VCG Mechanism}
\begin{definition}[Budget-Balanced VCG Mechanism]
    \normalfont
    A VCG mechanism is \textbf{budget-balanced} if $\sum_{i=1}^It_i(\theta)=0$.
\end{definition}

Based on the Proposition \ref{prop:Uniq_VCG_mechanism}, we can show the following corollary.
\begin{corollary}
    Suppose $I\geq 2$, $|K|\geq 2$, and $\forall i: \{v_i(\cdot,\theta_i): K \rightarrow \mathbb{R}\mid \theta_i\in\Theta_i\}=V_{usc}$. Then, there does not exist a budget-
    balanced VCG mechanism.
\end{corollary}


\begin{example}
    $K=\{0,1\},\Theta_i=[-1,1], v_i(k,\theta_i)=k\theta_i$. Take a VCG mechanism $k^*(\cdot)$ ex-post efficient, $h_1:\Theta_2 \rightarrow \mathbb{R}$, $h_2:\Theta_1 \rightarrow \mathbb{R}$.
    \begin{equation}
        \begin{aligned}
            t_1(\theta)+t_2(\theta)&=v_2(k^*(\theta),\theta_2)+h_1(\theta_2)+v_1(k^*(\theta),\theta_1)+h_2(\theta_1)\\
            &=\max\{0,\theta_1+\theta_2\}+h_1(\theta_2)+h_2(\theta_1)
        \end{aligned}
        \nonumber
    \end{equation}
    Suppose by the contradiction that it is a budget-balanced VCG mechanism.
    \begin{equation}
        \begin{aligned}
            \max\{0,\theta_1+\theta_2\}+h_1(\theta_2)+h_2(\theta_1)=0
        \end{aligned}
        \nonumber
    \end{equation}
    We have
    \begin{equation}
        \begin{aligned}
            h_2(1)-h_2(0)=\max\{0,\theta_1\}-\max\{0,\theta_1+1\}
        \end{aligned}
        \nonumber
    \end{equation}
    The LHS is constant and the RHS is a function of $\theta_1$, which gives a contradiction.
\end{example}


\subsection{Expected-externality Mechanism (BIC)}
\begin{definition}[EE Mechanism]
\normalfont
    $(k^*(\cdot),t(\cdot))$ is an Expected-externality (EE/AGV) mechanism if $k^*(\cdot)$ is ex-post efficient and there are functions $h_i:\Theta_i: \mathbb{R}$ for all $i$ s.t.
    \begin{equation}
        \begin{aligned}
            t_i(\theta)=\underbrace{\mathbb{E}_{\tilde{\theta}_{-i}}\left[\sum_{j\neq i}v_j(k^*(\theta_i,\tilde{\theta}_{-i}),\theta_j)\right]}_{\triangleq \xi_i(\theta_i)}+h_i(\theta_{-i})
        \end{aligned}
        \label{EE}
    \end{equation}
    where $\xi_i(\theta_i)\triangleq\mathbb{E}_{\tilde{\theta}_{-i}}\left[\sum_{j\neq i}v_j(k^*(\theta_i,\tilde{\theta}_{-i}))\right]$ is the expected externality $i$ imposes on others, from $i$'s interim perspective when her type is $\theta_i$.
\end{definition}

\begin{proposition}
    EE mechanisms are BIC.
\end{proposition}
\begin{proof}
    Take any $i$ and $\theta_i,\hat{\theta}_i\in\Theta_i$. $i$'s expected payoff from truthfully reproting is
    \begin{equation}
        \begin{aligned}
            &\mathbb{E}_{\tilde{\theta}_{-i}}\left[v_i(k^*(\theta_i,\tilde{\theta}_{-i}),\theta_i)+t_i(\theta_i,\tilde{\theta}_{-i})\right]\\
            \textnormal{(substitute \eqref{EE}) }=&\mathbb{E}_{\tilde{\theta}_{-i}}\left[\sum_{j=1}^I v_j(k^*(\theta_i,\tilde{\theta}_{-i}),\theta_j)\right]+\mathbb{E}_{\tilde{\theta}_{-i}}[h_i(\tilde{\theta}_{-i})]\\
           \textnormal{($k^*$ is ex-post efficient) } \geq& \mathbb{E}_{\tilde{\theta}_{-i}}\left[\sum_{j=1}^I v_j(k^*(\hat{\theta}_i,\tilde{\theta}_{-i}),\theta_j)\right]+\mathbb{E}_{\tilde{\theta}_{-i}}[h_i(\tilde{\theta}_{-i})]\\
           =& \mathbb{E}_{\tilde{\theta}_{-i}}\left[\sum_{j=1}^I v_j(k^*(\hat{\theta}_i,\tilde{\theta}_{-i}),\theta_j)\right]+\mathbb{E}_{\tilde{\theta}_{-i}}[t_i(\hat{\theta}_i,\tilde{\theta}_{-i})-\xi_i(\hat{\theta_i})]\\
           =&\mathbb{E}_{\tilde{\theta}_{-i}}\left[v_i(k^*(\hat{\theta}_i,\tilde{\theta}_{-i}),\theta_i)+t_i(\hat{\theta}_i,\tilde{\theta}_{-i})\right]
        \end{aligned}
        \nonumber
    \end{equation}
\end{proof}


\subsection{Budget-Balanced EE Mechanism}
Budget balancedness requires
\begin{equation}
    \begin{aligned}
        0=\sum_{i=1}^I t_i(\theta)=\sum_{i=1}^I[\xi_i(\theta_i)+h_i(\theta_{-i})] \Leftrightarrow \sum_{i=1}^I h_i(\theta_{-i})=-\sum_{i=1}^I \xi_i(\theta_i)
    \end{aligned}
    \nonumber
\end{equation}
Suppose $h_i(\theta_{-i})$ is in the form of $h_i(\theta_{-i})=c\sum_{j\neq i} \xi_j(\theta_j)$. Then,
\begin{equation}
    \begin{aligned}
        \sum_{i=1}^I h_i(\theta_{-i})=c(I-1)\sum_{i=1}^I \xi_i(\theta_i) \Rightarrow c=-\frac{1}{I-1}
    \end{aligned}
    \nonumber
\end{equation}
\begin{proposition}
    The EE mechanism where $h_i(\theta_{-i})=-\frac{1}{I-1}\sum_{j\neq i} \xi_j(\theta_j)$ is budget-balanced, $$t_i(\theta)=\xi_i(\theta_i)-\frac{1}{I-1}\sum_{j\neq i} \xi_j(\theta_j)$$
\end{proposition}

\begin{corollary}
    $\exists$ a BIC, ex-post efficient and budget-balanced direct mechanism.
\end{corollary}


\begin{example}
    Project choice with $K=\{0,1\}$, $\theta_i\sim U[-1,1]$, $v_j(k,\theta_j)=k\theta_j$. Let $k^*(\cdot)$ be:
    \begin{equation}
        \begin{aligned}
            k^*(\theta)=\left\{\begin{matrix}
                1,&\textnormal{ if }\theta_1+\theta_2\geq 0\\
                0,&\textnormal{ if }\theta_1+\theta_2<0
            \end{matrix}\right.
        \end{aligned}
        \nonumber
    \end{equation}
    Then,
    \begin{equation}
        \begin{aligned}
            \xi_i(\theta_i)&\triangleq\mathbb{E}_{\tilde{\theta}_{-i}}\left[v_{-i}(k^*(\theta_i,\tilde{\theta}_{-i}))\right]\\
            &=\int_{-1}^{-\theta_i}0\times \frac{1}{2} d\tilde{\theta}_{-i}+\int_{-\theta_i}^1 \tilde{\theta}_{-i}\times \frac{1}{2} d\tilde{\theta}_{-i}=\frac{1}{4}(1-\theta_i^2)
        \end{aligned}
        \nonumber
    \end{equation}
    Hence, the budget-balanced EE mechanism is given by
    \begin{equation}
        \begin{aligned}
            t_i(\theta_i)=\xi_i(\theta_i)-\xi_j(\theta_j)=\frac{1}{4}(\theta_j^2-\theta_i^2)
        \end{aligned}
        \nonumber
    \end{equation}
\end{example}

\subsection{Linear Utility Model}
Suppose types are real numbers $\Theta_i=[\underline{\theta}_i,\overline{\theta}_i]$ and $v_i(k,t,\theta_i)=\theta_i\cdot v_i(k)+t_i$, where $v_i:K \rightarrow \mathbb{R}_i$.

Given a direct mechanism $\left(\Theta,k(\cdot),t(\cdot)\right)$, define interim expected values of $v_i(\cdot)$ and $t_i(\cdot)$:
\begin{equation}
    \begin{aligned}
        \bar{v}_i(\theta_i)=\mathbb{E}_{\theta_{-i}}\left[v_i(\theta_i,\theta_{-i})\right]\\
        \bar{t}_i(\theta_i)=\mathbb{E}_{\theta_{-i}}\left[t_i(\theta_i,\theta_{-i})\right]
    \end{aligned}
    \nonumber
\end{equation}
The expected utility of agent $i$ when all agents report truthfully,
\begin{equation}
    \begin{aligned}
        U_i(\theta_i)&=\mathbb{E}_{\theta_{-i}}\left[\theta_iv_i(\theta_i,\theta_{-i})+t_i(\theta_i,\theta_{-i})\right]\\
        &=\theta_i \bar{v}_i(\theta_i)+\bar{t}_i(\theta_i)
    \end{aligned}
    \nonumber
\end{equation}

\begin{proposition}\label{Linear utility model_BIC}
    A direct mechanism $\left(\Theta,k(\cdot),t(\cdot)\right)$ is BIC \underline{iff} $\forall i\in\{1,...,I\}$
    \begin{enumerate}[(1).]
        \item $\bar{v}_i(\theta_i)$ is non-decreasing in $\theta_i$.
        \item $\forall \theta_i\in\Theta_i$, $U_i(\theta_i)=U_i(\underline{\theta}_i)+\int_{\underline{\theta}_i}^{\theta_i}\bar{v}_i(s)ds$
    \end{enumerate}
\end{proposition}
\begin{proof}
    ``$\Rightarrow$'': Given the direct mechanism is BIC. Take any $i$, $\theta_i,\hat{\theta}_i\in\Theta$, agents with $\theta_i,\hat{\theta}_i$ both report truthfully
    \begin{equation}
        \begin{aligned}
            \theta_i \bar{v}_i(\theta_i)+\bar{t}_i(\theta_i)&\geq \theta_i \bar{v}_i(\hat{\theta}_i)+\bar{t}_i(\hat{\theta}_i)\\
            \hat{\theta}_i \bar{v}_i(\hat{\theta}_i)+\bar{t}_i(\hat{\theta}_i)&\geq \hat{\theta}_i \bar{v}_i(\theta_i)+\bar{t}_i(\theta_i)\\
            \Rightarrow [\theta_i-\hat{\theta}_i][\bar{v}_i(\theta_i)-\bar{v}_i(\hat{\theta}_i)]&\geq 0
        \end{aligned}
        \nonumber
    \end{equation}
    Hence, $\bar{v}_i(\theta_i)$ is non-decreasing.\\
    $U_i(\theta_i)=\max_{\hat{\theta}_i\in\Theta_i}\left[\theta_i\bar{v}_i(\hat{\theta}_i)+t_i(\hat{\theta}_i)\right]$ by BIC is maximized at $\hat{\theta}_i=\theta_i$.\\
    By Envelope Theorem,
    \begin{equation}
        \begin{aligned}
            U_i(\theta_i)&=U_i(\underline{\theta}_i)+\int_{\underline{\theta}_i}^{\theta_i}U'_i(s)ds\\
            &=U_i(\underline{\theta}_i)+\int_{\underline{\theta}_i}^{\theta_i}\bar{v}_i(s)ds
        \end{aligned}
        \nonumber
    \end{equation}
    ``$\Leftarrow$'': Take any $i$, $\theta_i,\hat{\theta}_i\in\Theta$. $i$'s expected interim payoff from reporting $\hat{\theta}_i$ instead of $\theta_i$ is
    \begin{equation}
        \begin{aligned}
            &\underbrace{\theta_i \bar{v}_i(\theta_i)+\bar{t}_i(\theta_i)}_{U_i(\theta_i)}-\left[\theta_i \bar{v}_i(\hat{\theta}_i)+\bar{t}_i(\hat{\theta}_i)\right]\\
            =&U_i(\theta_i)-\left[U_i(\hat{\theta}_i)+(\theta-\hat{\theta}_i)\bar{v}_i(\hat{\theta}_i)\right]\\
            =&U_i(\underline{\theta}_i)+\int_{\underline{\theta}_i}^{\theta_i}\bar{v}_i(s)ds-[U_i(\underline{\theta}_i)+\int_{\underline{\theta}_i}^{\hat{\theta}_i}\bar{v}_i(s)ds]-(\theta-\hat{\theta}_i)\bar{v}_i(\hat{\theta}_i)\\
            =&\int_{\theta_i}^{\hat{\theta}_i}(\bar{v}_i(\hat{\theta}_i)-\bar{v}_i(s))ds\geq 0
        \end{aligned}
        \nonumber
    \end{equation}
    So the direct mechanism is BIC.
\end{proof}

\section{Auction}
Based on
\begin{enumerate}[$\circ$]
    \item Klemperer, P. (1998). Auctions with almost common values: The Wallet Game'and its applications. \textit{European Economic Review}, 42(3-5), 757-769.
\end{enumerate}


\subsection{Examples: Auctions with Common-value}
\begin{enumerate}[(1).]
    \item Financial assets;
    \item Oilfields;
    \item A takeover target has a common value if the bidders are financial acquirers (e.g. LBO firms) who will follow similar management strategies if successful;
    \item The Personal Communications Spectrum (PCS) licenses sold by the U.S. Government in the 1995 "Airwaves Auction".
\end{enumerate}

\subsection{First / Second Price Sealed-bid Auction}
\begin{enumerate}[$\circ$]
    \item A seller sells an indivisible object.
    \item There are $N=\{1,...,n\}$ bidders, $i\in N$.
    \item Each bidder has a valuation for the object, $X_i\sim F$, $x_i\in[\underline{x},\overline{x}]$. p.d.f. $f(\cdot)$ is strictly positive and continuous.
    \item Strategy of $i$: $b_i:[\underline{x},\overline{x}] \rightarrow \mathbb{R}$, a \underline{bid function}.
\end{enumerate}

\begin{assumption}
    1. Independence; 2. Symmetry; 3. Private Values; 4. Risk-neutrality.
\end{assumption}

Let $X=(X_1,...,X_n)$. The $k^{th}$-order statistic, $X^k$, is the $k^{th}$ the highest value in $X_1,...,X_n$.

\begin{definition}[Second Price Auction]
    \normalfont
    Highest bidder wins and pays the second-highest bid. (If more than one bidders bid the highest value, they win with equal probability.)\\
    It can be written as the form of Bayesian game: a bidder $i$'s utility function is
    \begin{equation}
        \begin{aligned}
            u_i(b_1,...,b_n;x_i)=\left\{\begin{matrix}
                \frac{1}{|\{j\in N:b_j=b_i\}|}x_i-b^2,&b_i=b^1\\
                0,&b_i\neq b^1
            \end{matrix}\right.
        \end{aligned}
        \nonumber
    \end{equation}
    where $b^k$ is the $k$-th highest bid.
\end{definition}

\begin{theorem}[Second Price Auction: Bid Truthfully]
    In the second-price sealed-bid auction, it is a (weakly) dominant strategy to bid your valuation, i.e., $\forall i\in N,\forall x_i\in[\underline{x},\overline{x}]$, $b_i(x_i)=x_i$.\\
    That is, $\forall i, \forall b'_i\in \mathbb{R}$,
    \begin{equation}
        \begin{aligned}
            u_i(x_i,b_{-i};x_i)\geq u_i(b'_i,b_{-i};x_i), \forall b_{-i}\in \mathbb{R}^{n-1}
        \end{aligned}
        \nonumber
    \end{equation}
    (Moreover, if $\exists b'_{i}\neq x_i$, then $\exists b_{-i}\in \mathbb{R}^{n-1}$ such that $u_i(x_i,b_{-i};x_i)> u_i(b'_{i},b_{-i};x_i)$.)
\end{theorem}
\begin{proof}
    Player $i$ has value $x_i$ and treats $b^1_{-i}$ as a random variable. The payoff conditional on winning is $$x_i-b^1_{-i}$$ By bidding $b_i=x_i$, $i$ ensures that $i$ wins if $b_i=x_i>b^1_{-i}\Leftrightarrow x_i-b^1_{-i}>0$ and $i$ loses if $b_i=x_i<b^1_{-i}\Leftrightarrow x_i-b^1_{-i}<0$.
\end{proof}

\begin{definition}[First Price Auction]
    \normalfont
    Highest bidder wins and pays her bid. (If more than one bidder bid the highest value, they win with equal probability.)\\
    It can be written as the form of Bayesian game: a bidder $i$'s utility function is
    \begin{equation}
        \begin{aligned}
            u_i(b_1,...,b_n;x_i)=\left\{\begin{matrix}
                \frac{1}{|\{j\in N:b_j=b_i\}|}x_i-b_i,&b_i=b^1\\
                0,&b_i\neq b^1
            \end{matrix}\right.
        \end{aligned}
        \nonumber
    \end{equation}
    where $b^k$ is the $k$-th highest bid.
\end{definition}


\subsubsection*{Bayesian Nash Equilibrium Analysis of First Price Auction}
Conjecture that $\exists$ a BNE with the following properties:
\begin{enumerate}
    \item Symmetry: $b_1(\cdot)=b_2(\cdot)=\cdots=b_n(\cdot):=b(\cdot)$.
    \item $b(\cdot)$ is differentiable.
    \item $b'(\cdot)>0$.
\end{enumerate}
Take any bidder $i$ with valuation $x_i$. Assume $i$ knows $b(\cdot)$ and knows that the other bidder use the same $b(\cdot)$. Take any $b_i\in \mathbb{R}$ ($b_i:=b(x_i)$). (Not that, by the continuity of $X_i$, it is impossible to tie in this case.)

Then, $i$'s expected payoff from bidding $b_i$ is
\begin{equation}
    \begin{aligned}
        P(b(X_j)\leq b_i,\forall j\neq i)(x_i-b_i)=F^{n-1}(b^{-1}(b_i))(x_i-b_i)
    \end{aligned}
    \nonumber
\end{equation}
The necessary F.O.C. gives that optimal $b_i$ satisfies
\begin{equation}
    \begin{aligned}
        (n-1)f(b^{-1}(b_i))\frac{1}{b'(b^{-1}(b_i))}F^{n-2}(b^{-1}(b_i))(x_i-b_i)-F^{n-1}(b^{-1}(b_i))=0
    \end{aligned}
    \nonumber
\end{equation}
Since $b(\cdot)$ is a symmetric BNE, the optimal $b_i$ must be $b(x_i)$, then $b^{-1}(b_i)=x_i$.
\begin{equation}
    \begin{aligned}
        (n-1)f(x_i)\frac{1}{b'(x_i)}F^{n-2}(x_i)(x_i-b(x_i))-F^{n-1}(x_i)=0
    \end{aligned}
    \nonumber
\end{equation}
Hence,
\begin{equation}
    \begin{aligned}
        \underbrace{(n-1)f(x_i)F^{n-2}(x_i)x_i+F^{n-1}(x_i)}_{\frac{\partial F^{n-1}(x_i)x_i}{\partial x_i}}-F^{n-1}(x_i)=\underbrace{(n-1)f(x_i)F^{n-2}(x_i)b(x_i)+b'(x_i)F^{n-1}(x_i)}_{\frac{\partial F^{n-1}(x_i)b(x_i)}{\partial x_i}}
    \end{aligned}
    \nonumber
\end{equation}
Taking integral at both sides in $[\underline{x},x]$,
\begin{equation}
    \begin{aligned}
        F^{n-1}(x)x-\int_{\underline{x}}^x F^{n-1}(t) dt= F^{n-1}(x)b(x)
    \end{aligned}
    \nonumber
\end{equation}
That is,
\begin{equation}
    \begin{aligned}
        b(x)=x-\frac{1}{F^{n-1}(x)}\int_{\underline{x}}^x F^{n-1}(t) dt
    \end{aligned}
    \label{FPA:symmetric BNE}
\end{equation}
Note $b(\cdot)$ is differentiable and $b'(\cdot)>0$. We can extend $b(\cdot)$ to $[\underline{x},\overline{x}]$ by setting $b(\underline{x})=\lim_{x \rightarrow \underline{x}} b(x)=\underline{x}$.

\begin{proposition}[Symmetric BNE of First Price Auction]
    $b(x)=x-\frac{1}{F^{n-1}(x)}\int_{\underline{x}}^x F^{n-1}(t) dt$ is a symmetric BNE of First Price Auction.
\end{proposition}
\begin{proof}
    Any bid higher than $b(\overline{x})$ is suboptimal, and any bid lower than $b(\underline{x})$ is indifferent to the $b(\underline{x})$.\\
    We prove that, for a bidder with $x_i$, she prefers to bid $b(x_i)$ than $b(y),\forall y$.\\
    Bidding $b(y)$ gives expected payoff
    \begin{equation}
        \begin{aligned}
            F^{n-1}(y)(x_i-b(y))&=F^{n-1}(y)(y-b(y))+F^{n-1}(y)(x_i-y)\\
            (\textnormal{by \eqref{FPA:symmetric BNE}})&=\int_{\underline{x}}^y F^{n-1}(t) dt+F^{n-1}(y)(x_i-y)\\
            &=\int_{\underline{x}}^{x_i} F^{n-1}(t) dt-\underbrace{\int_y^{x_i} [F^{n-1}(t)-F^{n-1}(y)] dt}_{\geq 0, \textnormal{ minimized at }y=x_i}
        \end{aligned}
        \nonumber
    \end{equation}
\end{proof}

\begin{theorem}[Lebrun, 1999]
    Consider the bid function $b(\cdot)$ in \eqref{FPA:symmetric BNE}, the First Price Auction has essentially unique. (Bidders with types $x>\underline{x}$ bid $b(x)$ and bid for type $x=\underline{x}$ is not pinned down any further than the support $b_i(\underline{x})$ must lie in $(-\infty,b(\underline{x})]$.)
\end{theorem}

The equilibrium expected payoffs of a bidder in first-price auction and second price auction with valuation $x$ is
\begin{equation}
    \begin{aligned}
        \int_{\underline{x}}^x F^{n-1}(t)dt
    \end{aligned}
    \nonumber
\end{equation}
The equilibrium expected revenue of the seller in first-price auction and second price auction is
\begin{equation}
    \begin{aligned}
        \overline{x}-\int_{\underline{x}}^{\overline{x}} [nF^{n-1}(t)-(n-1)F^n(t)]dt
    \end{aligned}
    \nonumber
\end{equation}




\section{Revenue Equivalence Theorem and Optimal Auctions}
Consider the Optimal Auctions in an Independent Private Values Setting. There is one object and $N$ bidders.
\begin{enumerate}
    \item Bidders are risk-neutral;
    \item Bidders have private valuations;
    \item each bidder $i$'s valuation independently drawn from a strictly increasing c.d.f. $F_i(v)$ (with p.d.f. $f_i(v),v\in \mathcal{X}_i$) that is continuous and bounded below;
    \item Seller knows each $F_i$ (use $F$ and $f$ to represent all distributions) and have no value for the object.
\end{enumerate}

\begin{comment}
\begin{definition}[General Auction]
    \normalfont
    A general auction mechanism: bidders have values $x$ and \textbf{strategies} $\beta: \mathcal{X}\triangleq \prod_i^N \mathcal{X}_i \rightarrow \mathcal{B}$ generate message (bids) based on their values, then there is an \textbf{allocation rule} based on bids $\pi: \mathcal{B} \rightarrow \Delta N$ generates a distribution over all bidders and a \textbf{payment rule} $\mu: \mathcal{B} \rightarrow \mathbb{R}^N$ generates payment for all bidders.
\end{definition}

\begin{definition}[Direct Mechansim]
    \normalfont
    Consider a situation that bidders follow \textit{revelation principle} that provide their true values. Then the outcome can directly base on the true values.\\
    Then a \textbf{direct mechanism} can be represented as $(Q,T)$, where $Q: \mathcal{X} \rightarrow \Delta N$ is the allocation rule and $T: \mathcal{X} \rightarrow \mathbb{R}^N$ is the payment rule, such that
    \begin{equation}
        \begin{aligned}
            Q(x)=\pi(\beta(x)),\quad T(x)=\mu(\beta(x))
        \end{aligned}
        \nonumber
    \end{equation}
\end{definition}

\begin{proposition}[Revelation Principle]
    Take any equilibrium of any auction mechanism $(\mathcal{B},\pi,\mu)$. There is a distinct direct mechanism $(Q,T)$ that produces the same outcome.
\end{proposition}


Consider a direct mechanism $(Q,T)$, an agent $i$ reports $v_i$ while others report their values.
\begin{equation}
    \begin{aligned}
        \textbf{Expected allocation: }&q_i(z_i)=\int_{\mathcal{X}_{-i}}Q_i(z_i,x_{-i})dF_{-i}(x_{-i})\\
        \textbf{Expected payment: }&t_i(z_i)=\int_{\mathcal{X}_{-i}}T_i(z_i,x_{-i})dF_{-i}(x_{-i})
    \end{aligned}
    \nonumber
\end{equation}
where $Q_i, T_i$ are $i^\textnormal{th}$ item of $Q,T$.\\
The bidder wants to maximize
\begin{equation}
    \begin{aligned}
        q_i(z_i) x_i - t_i(z_i)
    \end{aligned}
    \nonumber
\end{equation}
Define the maximum value is
\begin{equation}
    \begin{aligned}
        u_i(x_i)=\max_{z_i\in \mathcal{X}_i}\{q_i(z_i) x_i - t_i(z_i)\}
    \end{aligned}
    \nonumber
\end{equation}

\begin{assumption}
    The condition for direct mechanism being incentive competitive (IC) is:
    \begin{equation}
        \begin{aligned}
            u_i(x_i)\equiv q_i(x_i) x_i - t_i(x_i)\geq q_i(z_i) x_i - t_i(z_i), \forall x_i, z_i\in \mathcal{X}_i
        \end{aligned}
        \tag{Ass 1}
        \label{Ass 1}
    \end{equation}
\end{assumption}


Firstly, we can compute, for any $z_i\in \mathcal{X}_i$
\begin{equation}
    \begin{aligned}
        &q_i(x_i)z_i-t_i(x_i)\\
        =&q_i(x_i)x_i-t_i(x_i)+q_i(x_i)(z_i-x_i)\\
        =&u_i(x_i)+q_i(x_i)(z_i-x_i)
    \end{aligned}
    \nonumber
\end{equation}
Based on the assumption \ref{Ass 1}, we have
\begin{equation}
    \begin{aligned}
        u_i(z_i)\geq q_i(x_i)z_i-t_i(x_i)=u_i(x_i)+q_i(x_i)(z_i-x_i)
    \end{aligned}
    \nonumber
\end{equation}
which shows that $u_i(\cdot)$ is convex.

If $u_i$ is differentiable, $u'_i(x_i)=q_i(x_i)$. Then, we can write the \textbf{Envelope theorem/condition}:
\begin{equation}
    \begin{aligned}
        u_i(x_i)=u_i(0)+\int_0^{x_i} q_i(y_i)dy_i
    \end{aligned}
    \nonumber
\end{equation}
which only depends on the allocation rule.

\begin{theorem}[Revenue Equivalence Theorem]
    If the direct mechanism $(Q,T)$ is incentive competitive (IC), then for all $i,x$, the \textbf{expected payment} is
    \begin{equation}
        \begin{aligned}
            t_i(x_i)=\underbrace{t_i(0)}_{e.g.=0}+q_i(x_i)x_i-\int_0^{x_i} q_i(y_i)dy_i
        \end{aligned}
        \nonumber
    \end{equation}
\end{theorem}
\begin{proof}
    \begin{equation}
        \begin{aligned}
            u_i(x_i)= q_i(x_i) x_i - t_i(x_i)=u_i(0)+\int_0^{x_i} q_i(y_i)dy_i\\
            \Rightarrow t_i(x_i)=q_i(x_i)x_i-u_i(0)-\int_0^{x_i} q_i(y_i)dy_i
        \end{aligned}
        \nonumber
    \end{equation}
    Set $u_i(0)=-t_i(0)$, that is, if $i$'s value is zero, he pays zero.
\end{proof}

\begin{corollary}[Standard Revenue Equivalence Theorem]
    Suppose that values are \underline{i.i.d.} and bidders are \underline{risk-neutral}.\\
    Consider any auction and its \underline{symmetric} and \underline{increasing} equilibrium, in which the expected payment of bidders have $0$ value is $0$. Then the expected revenue to the seller is the \underline{same}.
\end{corollary}
\begin{proof}
    If equilibrium, is symmetric and increasing, then object is \underline{always} allocated to the bidder with the highest value. Set $t_i(0)=0$.
\end{proof}

Standard Revenue Equivalence Theorem is based on \underline{symmetric}, \underline{independent}, and \underline{private} (uncorrelated) values.
\end{comment}

















\underline{Goal:} Find the \textbf{optimal auction} that maximizes the seller's expected revenue subject to individual rationality (IR) and Bayesian incentive compatibility for the buyers.



\subsection{IR, BIC, Direct Mechanism}
Given a direct mechanism $\left(\Theta,y(\cdot),t(\cdot)\right)$, define
\begin{equation}
    \begin{aligned}
        \bar{y}_i(\theta_i)=\mathbb{E}_{\theta_{-i}}\left[y_i(\theta_i,\theta_{-i})\right]\\
        \bar{t}_i(\theta_i)=\mathbb{E}_{\theta_{-i}}\left[t_i(\theta_i,\theta_{-i})\right]
    \end{aligned}
    \nonumber
\end{equation}
The expected utility of agent $i$ when all agents report truthfully,
\begin{equation}
    \begin{aligned}
        U_i(\theta_i)&=\mathbb{E}_{\theta_{-i}}\left[\theta_iy_i(\theta_i,\theta_{-i})+t_i(\theta_i,\theta_{-i})\right]\\
        &=\theta_i \bar{y}_i(\theta_i)+\bar{t}_i(\theta_i)
    \end{aligned}
    \nonumber
\end{equation}

\begin{definition}[Individual Rationality]
    \normalfont
    A direct mechanism $\left(\Theta,y(\cdot),t(\cdot)\right)$ is \textbf{individual rationality (IR)} if $\forall i,\theta_i\in\Theta_i$, $U_i(\theta_i)\geq 0$.
\end{definition}

\begin{corollary}[Corollary of Proposition \ref{Linear utility model_BIC}]
    A direct mechanism $\left(\Theta,y(\cdot),t(\cdot)\right)$ is \textbf{BIC and IR} iff $\forall i\in\{1,...,I\}$
    \begin{enumerate}[(1).]
        \item $\bar{y}_i(\theta_i)$ is non-decreasing in $\theta_i$.
        \item $\forall \theta_i\in\Theta_i$, $U_i(\theta_i)=U_i(\underline{\theta}_i)+\int_{\underline{\theta}_i}^{\theta_i}\bar{y}_i(s)ds$
        \item $U_i(\underline{\theta}_i)\geq 0$
    \end{enumerate}
\end{corollary}
For a BIC $\&$ IR mechanism, $\bar{t}_i(\theta_i)$ can be represented as
\begin{equation}
    \begin{aligned}
        U_i(\theta_i)&=U_i(\underline{\theta}_i)+\int_{\underline{\theta}_i}^{\theta_i}\bar{y}_i(s)ds\\
        \theta_i \bar{y}_i(\theta_i)+\bar{t}_i(\theta_i)&=U_i(\underline{\theta}_i)+\int_{\underline{\theta}_i}^{\theta_i}\bar{y}_i(s)ds
    \end{aligned}
    \nonumber
\end{equation}
\begin{equation}
    \begin{aligned}
        \bar{t}_i(\theta_i)&=-\theta_i \bar{y}_i(\theta_i)+U_i(\underline{\theta}_i)+\int_{\underline{\theta}_i}^{\theta_i}\bar{y}_i(s)ds
    \end{aligned}
    \label{t_star}
\end{equation}

\subsection{Revenue Equivalence Theorem}
For a BIC $\&$ IR direct mechanism, the \textit{seller's expected revenues} from bidder $i$:
\begin{equation}
    \begin{aligned}
        \mathbb{E}_\theta[-t_i(\theta)]&=-\int_\Theta t_i(\theta)f(\theta) d\theta\\
        &=-\int_{\Theta_i} \underbrace{\left(\int_{\Theta_{-i}}t_i(\theta_i,\theta_{-i})f_{-i}(\theta_{-i})d\theta_{-i}\right)}_{\bar{t}_i(\theta_i)}f_i(\theta_i) d\theta_i\\
        &=-\int_{\underline{\theta}_i}^{\overline{\theta}_i}\left(-\theta_i \bar{y}_i(\theta_i)+U_i(\underline{\theta}_i)+\int_{\underline{\theta}_i}^{\theta_i}\bar{y}_i(s)ds\right)f_i(\theta_i) d\theta_i\\
        &=-\underbrace{\int_{\underline{\theta}_i}^{\overline{\theta}_i}\int_{\underline{\theta}_i}^{\theta_i}\bar{y}_i(s)dsf_i(\theta_i) d\theta_i}_{\triangleq \star}+\int_{\underline{\theta}_i}^{\overline{\theta}_i}\theta_i \bar{y}_i(\theta_i)f_i(\theta_i) d\theta_i-U_i(\underline{\theta}_i)
    \end{aligned}
    \nonumber
\end{equation}
applying integration by parts
\begin{equation}
    \begin{aligned}
        \star&=\int_{\underline{\theta}_i}^{\overline{\theta}_i}\left(\int_{\underline{\theta}_i}^{\theta_i}\bar{y}_i(s)ds\right)d F_i(\theta_i)\\
        &=\left(\int_{\underline{\theta}_i}^{\theta_i}\bar{y}_i(s)ds\right)F_i(\theta_i)\bigg|_{\underline{\theta}_i}^{\overline{\theta}_i}-\int_{\underline{\theta}_i}^{\overline{\theta}_i}F_i(\theta_i)d\left(\int_{\underline{\theta}_i}^{\theta_i}\bar{y}_i(s)ds\right)\\
        &=\int_{\underline{\theta}_i}^{\overline{\theta}_i}\bar{y}_i(s)ds-\int_{\underline{\theta}_i}^{\overline{\theta}_i}\bar{y}_i(\theta_i)F_i(\theta_i)d\theta_i\\
        &=\int_{\underline{\theta}_i}^{\overline{\theta}_i}(1-F_i(s))\bar{y}_i(s) ds
    \end{aligned}
    \nonumber
\end{equation}
Hence,
\begin{equation}
    \begin{aligned}
        \mathbb{E}_\theta[-t_i(\theta)]&=-\int_{\underline{\theta}_i}^{\overline{\theta}_i}(1-F_i(\theta_i))\bar{y}_i(\theta_i) d\theta_i+\int_{\underline{\theta}_i}^{\overline{\theta}_i}\theta_i \bar{y}_i(\theta_i)f_i(\theta_i) d\theta_i-U_i(\underline{\theta}_i)\\
        &=\int_\Theta y_i(\theta)\left[\theta_i-\frac{1-F_i(\theta_i)}{f_i(\theta_i)}\right]f(\theta)d\theta-U_i(\underline{\theta}_i)
    \end{aligned}
    \nonumber
\end{equation}
The \textit{total expected revenue of the seller} is
\begin{equation}
    \begin{aligned}
        \int_\Theta \sum_{i=1}^I y_i(\theta)\left[\theta_i-\frac{1-F_i(\theta_i)}{f_i(\theta_i)}\right]f(\theta)d\theta-\sum_{i=1}^IU_i(\underline{\theta}_i)
    \end{aligned}
    \label{eq:revenue}
\end{equation}

\begin{theorem}[Revenue Equivalence Theorem]
    BIC $\&$ IR direct mechanisms with the same allocation rule $y(\cdot)$ and the same utilities $(U_i(\underline{\theta}_i))_{i=1,...,I}$ generate the same revenues \eqref{eq:revenue} and the same expected payments of all types 
    \begin{enumerate}
        \item BIC, and IR auction mechanisms that have the same allocation rule $y(\cdot)$ and the same utilities $(U_i(\theta_i))_{i=1,...,I}$ generate the same revenues \eqref{eq:revenue}.
        \item Take two auction formats $A$ and $B$, fix a BNE of $A$ and a BNE of $B$, interim expected payoff of $\underline{\theta}_i$ is the same for both $A$ and $B$.
    \end{enumerate}
\end{theorem}

\subsection{Optimal Auctions}
The optimal auction design is given by
\begin{equation}
    \begin{aligned}
        \max_{\textnormal{BIC and IR }f(\cdot)}\int_\Theta \sum_{i=1}^I y_i(\theta)\left[\theta_i-\frac{1-F_i(\theta_i)}{f_i(\theta_i)}\right]f(\theta)d\theta-\sum_{i=1}^IU_i(\underline{\theta}_i)
    \end{aligned}
    \nonumber
\end{equation}

\begin{definition}[Virtual Valuation]
    \normalfont
    Define bidder $i$'s \textbf{virtual valuation} is $c_i(v_i)=v_i-\frac{1-F_i(v_i)}{f(v_i)}$.
\end{definition}

\begin{assumption}[Regularity Condition]
    Any bidder $i$'s virtual valuation $c_i(v_i)=v_i-\frac{1-F_i(v_i)}{f(v_i)}$ is strictly increasing.
\end{assumption}

\begin{corollary}[Optimal Auction Mechanism]
    Assume regularity. Then the expected revenue maximizing direct auction mechanism $(y(\cdot),t(\cdot))$ can be described as follows
    \begin{enumerate}[(1).]
        \item $y(\cdot): \Theta \rightarrow K$ is defined as follows. For any $\theta\in \Theta$, $\max_{i\in\{1,...,I\}}c_i(\theta_i)<0$, the seller keeps the object ($y_i(\theta)=0,\forall _i$). Otherwise, the object is allocated to a highest virtual valuation bidder.
        \item Define $t(\cdot):\Theta \rightarrow K$,
        \begin{equation}
            \begin{aligned}
                t_i(\theta):=-\theta_i y_i(\theta_i,\theta_{-i})+U_i(\underline{\theta}_i)+\int_{\underline{\theta}_i}^{\theta_i}y_i(s,\theta_{-i})ds
            \end{aligned}
            \nonumber
        \end{equation}
        which satisfies \eqref{t_star}.
    \end{enumerate}
\end{corollary}

\begin{example}
    Suppose $\Theta_i=[0,1],\theta_i\sim U[0,1]$. $c_i(\theta_i)=\theta_i-\frac{1-\theta_i}{1}=2\theta_i-1$, which is strictly increasing in $\theta_i$ (regularity satisfied). Then, the optimal auction mechanism is allocating the object to the highest (virtual) valuation bidder (iff his value $\theta_i\geq\frac{1}{2}$).
\end{example}

\begin{definition}[Bidder-Specific Reserve Price]
    \normalfont
    Bidder $i$'s bidder-specific reserve price $r_i^*$ is the value for which $c_i(r_i^*)=0$.
\end{definition}

\begin{theorem}[Myerson (1981)]
    The optimal (single-good) auction in terms of a direct mechanism: The good is sold to the agent $i=\arg\max_i\phi_i(\hat{v}_i)$, as long as $v_i\geq r_i^*$. If the good is sold, the winning agent $i$ is charged the smallest valuation that he could have declared while still remaining the winner:
    \begin{equation}
        \begin{aligned}
            \inf\{v_i^*:c_i(v_i^*)\geq 0 \textnormal{ and }\forall j\neq i, c_i(v_i^*)\geq c_j(\hat{v}_j)\}
        \end{aligned}
        \nonumber
    \end{equation}
\end{theorem}












\end{document}